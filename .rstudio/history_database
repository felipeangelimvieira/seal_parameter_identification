1607785744706:setwd("~/R")
1607785747280:.libPaths("lib/")
1607785779293:setwd("~/R")
1607785780801:.libPaths("lib/")
1607785781511:packages.to.install <- c("ggplot",
1607785781525:"data.table")
1607785781936:install.packages(packages.to.install, dependencies=T)
1607786436296:knitr::opts_chunk$set(echo = T,
1607786436327:message=FALSE,
1607786436359:warning = F,
1607786436390:results = 'asis',
1607786436425:fig.align='center',  out.height= '100%',
1607786436455:fig.pos='H',
1607786436492:out.width="100%",
1607786436528:fig.margin=F)
1607786436568:options("kableExtra.html.bsTable" = T)
1607786436609:options(tinytex.verbose = TRUE)
1607786436647:options(knitr.kable.NA = "-")
1607786436683:rm(list = setdiff(objects(),c("main.directory","usuario", "params") ))
1607787336454:packages.to.install <- c("ggplot",
1607787336475:"data.table",
1607787336495:"assertthat")
1607787336876:install.packages(packages.to.install, dependencies=T)
1607787469526:matrix(nrow=3, ncol=3)
1607787605348:inv(matrix(nrow=3, ncol=3) )
1607787625850:library(matlib)
1607787630494:install.packages("matlib")
1607787954676:library(matlib)
1607787989926:A
1607788024406:5 %% 2
1607788047461:factorial
1607788063798:factorial(3)
1607788074366:return(H[derivative,]*factorial(derivative))
1607788075425:filter.coef <- function(width, order, derivative=0) {
1607788075441:stopifnot(width %% 2 == 1)
1607788075462:# half-width
1607788075480:M <- (width - 1)/2
1607788075497:A <- matrix(0,
1607788075516:nrow=width,
1607788075534:ncol=order)
1607788075556:for (n in 1:width){
1607788075573:for (i in 1:order){
1607788075589:A[n, i] <- (n-M)**2
1607788075605:}
1607788075623:}
1607788075646:H = solve(t(A) %*% A) %*% t(A)
1607788075671:return(H[derivative,]*factorial(derivative))
1607788075701:}
1607788083293:filter.coef(61, 12)
1607788092710:filter.coef <- function(width, order, derivative=0) {
1607788092727:stopifnot(width %% 2 == 1)
1607788092748:# half-width
1607788092765:M <- (width - 1)/2
1607788092783:A <- matrix(0,
1607788092799:nrow=width,
1607788092817:ncol=order)
1607788092840:for (n in 1:width){
1607788092861:for (i in 1:order){
1607788092878:A[n, i] <- (n-M)**2
1607788092897:}
1607788092916:}
1607788092940:print(A)
1607788092958:H = solve(t(A) %*% A) %*% t(A)
1607788092979:return(H[derivative,]*factorial(derivative))
1607788093013:}
1607788093139:filter.coef(61, 12)
1607788109452:width = 61
1607788112965:grau = 12
1607788115229:derivada = 0
1607788144270:stopifnot(width %% 2 == 1)
1607788144803:# half-width
1607788144819:M <- (width - 1)/2
1607788145668:A <- matrix(0,
1607788145686:nrow=width,
1607788145702:ncol=order)
1607788160157:order = 12
1607788162934:A <- matrix(0,
1607788162950:nrow=width,
1607788162966:ncol=order)
1607788164637:A
1607788166948:for (n in 1:width){
1607788166966:for (i in 1:order){
1607788166982:A[n, i] <- (n-M)**2
1607788167001:}
1607788167016:}
1607788173361:A %>% dims
1607788179293:dim(A)
1607788184549:t(A) %*% A
1607788188560:solve(t(A) %*% A)
1607788194552:A
1607788199004:t(A) %*% A
1607788208085:A
1607788217611:A
1607788219240:t(A)
1607788240981:t(A) %*% A
1607788252294:width=11
1607788258949:order=2
1607788261350:stopifnot(width %% 2 == 1)
1607788261990:# half-width
1607788262008:M <- (width - 1)/2
1607788262726:A <- matrix(0,
1607788262741:nrow=width,
1607788262761:ncol=order)
1607788264054:for (n in 1:width){
1607788264076:for (i in 1:order){
1607788264093:A[n, i] <- (n-M)**2
1607788264108:}
1607788264125:}
1607788264846:print(A)
1607788273743:t(A) %*% A
1607788315782:A <- matrix(0,
1607788315799:nrow=width,
1607788315814:ncol=order)
1607788316233:for (n in 0:(width-1)){
1607788316252:for (i in 0:(order-1)){
1607788316269:A[n+1, i+1] <- (n-M)**2
1607788316287:}
1607788316305:}
1607788318484:t(A) %*% A
1607788320181:A
1607788351772:A
1607788359492:n
1607788362848:i
1607788367076:i
1607788370036:A[10, 1]
1607788388615:# half-width
1607788388631:M <- (width - 1)/2
1607788389717:A <- matrix(0,
1607788389734:nrow=width,
1607788389750:ncol=order)
1607788390021:for (n in 0:(width-1)){
1607788390037:for (i in 0:(order-1)){
1607788390056:A[n+1, i+1] <- (n-M)**2
1607788390075:}
1607788390093:}
1607788391492:A
1607788402863:A <- matrix(0,
1607788402879:nrow=width,
1607788402895:ncol=order)
1607788403422:for (n in 0:(width-1)){
1607788403438:for (i in 0:(order-1)){
1607788403453:A[n+1, i+1] <- (n-M)**i
1607788403468:}
1607788403486:}
1607788406861:A
1607788412356:H = solve(t(A) %*% A) %*% t(A)
1607788418150:H[derivative+1,]*factorial(derivative)
1607788422606:derivative = 0
1607788424596:H[derivative+1,]*factorial(derivative)
1607788440013:filter.coef(11, 2)
1607788442354:filter.coef <- function(width, order, derivative=0) {
1607788442370:stopifnot(width %% 2 == 1)
1607788442406:# half-width
1607788442422:M <- (width - 1)/2
1607788442440:A <- matrix(0,
1607788442457:nrow=width,
1607788442473:ncol=order)
1607788442499:for (n in 0:(width-1)){
1607788442515:for (i in 0:(order-1)){
1607788442530:A[n+1, i+1] <- (n-M)**i
1607788442546:}
1607788442563:}
1607788442592:H = solve(t(A) %*% A) %*% t(A)
1607788442617:return(H[derivative+1,]*factorial(derivative))
1607788442646:}
1607788442667:filter.coef(11, 2)
1607788504430:coefs <- filter.coef(61, 12)
1607788504765:data = data.table(x=1:length(coefs),
1607788504782:y=coefs)
1607788595772:width=61;order=12
1607788598075:stopifnot(width %% 2 == 1)
1607788598268:# half-width
1607788598285:M <- (width - 1)/2
1607788598437:A <- matrix(0,
1607788598456:nrow=width,
1607788598472:ncol=order)
1607788605226:for (n in 0:(width-1)){
1607788605242:for (i in 0:(order-1)){
1607788605259:A[n+1, i+1] <- (n-M)^i
1607788605275:}
1607788605292:}
1607788605926:H = solve(t(A) %*% A) %*% t(A)
1607788608951:t(A) %*% A
1607788616048:solve(t(A) %*% A)
1607788649278:pinv(t(A) %*% A)
1607788741332:filter.coef <- function(width, order, derivative=0) {
1607788741355:stopifnot(width %% 2 == 1)
1607788741390:# half-width
1607788741406:M <- (width - 1)/2
1607788741420:A <- matrix(0,
1607788741435:nrow=width,
1607788741451:ncol=order)
1607788741474:for (n in 0:(width-1)){
1607788741491:for (i in 0:(order-1)){
1607788741507:A[n+1, i+1] <- (n-M)^i
1607788741524:}
1607788741542:}
1607788741574:H = solve(t(A) %*% A) %*% t(A)
1607788741598:return(H[derivative+1,]*factorial(derivative))
1607788741629:}
1607788742957:coefs <- filter.coef(61, 3)
1607788749406:coefs <- filter.coef(61, 5)
1607788752372:coefs <- filter.coef(61, 6)
1607788755155:coefs <- filter.coef(61, 7)
1607788791516:filter.coef <- function(width, order, derivative=0) {
1607788791535:stopifnot(width %% 2 == 1)
1607788791571:# half-width
1607788791591:M <- (width - 1)/2
1607788791608:A <- matrix(0,
1607788791625:nrow=width,
1607788791643:ncol=order)
1607788791669:for (n in 0:(width-1)){
1607788791687:for (i in 0:(order-1)){
1607788791704:A[n+1, i+1] <- (n-M)^i
1607788791721:}
1607788791740:}
1607788791774:H = solve((t(A) %*% A)*1e10)*1e10 %*% t(A)
1607788791797:return(H[derivative+1,]*factorial(derivative))
1607788791830:}
1607788794157:coefs <- filter.coef(61, 7)
1607788803810:1e10
1607788811755:filter.coef <- function(width, order, derivative=0) {
1607788811772:stopifnot(width %% 2 == 1)
1607788811812:# half-width
1607788811829:M <- (width - 1)/2
1607788811846:A <- matrix(0,
1607788811862:nrow=width,
1607788811877:ncol=order)
1607788811903:for (n in 0:(width-1)){
1607788811920:for (i in 0:(order-1)){
1607788811937:A[n+1, i+1] <- (n-M)^i
1607788811955:}
1607788811972:}
1607788812004:H = solve((t(A) %*% A)*1e20)*1e20 %*% t(A)
1607788812027:return(H[derivative+1,]*factorial(derivative))
1607788812061:}
1607788814347:coefs <- filter.coef(61, 7)
1607788829725:coefs <- filter.coef(61, 7)
1607788833147:coefs <- filter.coef(61, 6)
1607788838645:filter.coef <- function(width, order, derivative=0) {
1607788838662:stopifnot(width %% 2 == 1)
1607788838699:# half-width
1607788838717:M <- (width - 1)/2
1607788838732:A <- matrix(0,
1607788838751:nrow=width,
1607788838768:ncol=order)
1607788838796:for (n in 0:(width-1)){
1607788838811:for (i in 0:(order-1)){
1607788838827:A[n+1, i+1] <- (n-M)^i
1607788838843:}
1607788838859:}
1607788838888:H = solve((t(A) %*% A)) %*% t(A)
1607788838911:return(H[derivative+1,]*factorial(derivative))
1607788838943:}
1607788841115:coefs <- filter.coef(61, 6)
1607788843247:data = data.table(x=1:length(coefs),
1607788843267:y=coefs)
1607788845851:library(ggplot)
1607788846004:library(data.table)
1607788853443:library(ggplot2)
1607788869189:install.packages("ggplot")
1607788876586:install.packages("ggplot2")
1607788966256:library(data.table)
1607788969177:library(ggplot2)
1607788974058:coefs <- filter.coef(61, 6)
1607788974210:data = data.table(x=1:length(coefs),
1607788974228:y=coefs)
1607788975100:ggplot(data) +
1607788975118:geom_line(aes(x=x, y=y))
1607789018860:ggplot(data) +
1607789018878:geom_line(aes(x=x, y=y))+
1607789018895:theme_classic()
1607789027707:ggplot(data) +
1607789027722:geom_line(aes(x=x, y=y))+
1607789027738:theme_dark()
1607789071194:library(ggthemes)
1607789079786:install.packages("ggthemes")
1607789096425:library(ggthemes)
1607789101666:ggplot(data) +
1607789101685:geom_line(aes(x=x, y=y))+
1607789101702:theme_fivethirtyeight()
1607789107762:ggplot(data) +
1607789107781:geom_line(aes(x=x, y=y))+
1607789107798:theme_bw()
1607789121682:coefs <- filter.coef(61, 3)
1607789121844:data = data.table(x=1:length(coefs),
1607789121863:y=coefs)
1607789121962:ggplot(data) +
1607789121981:geom_line(aes(x=x, y=y))+
1607789122000:theme_bw()
1607789130202:coefs <- filter.coef(121, 4)
1607789130385:data = data.table(x=1:length(coefs),
1607789130403:y=coefs)
1607789130499:ggplot(data) +
1607789130516:geom_line(aes(x=x, y=y))+
1607789130537:theme_bw()
1607789170878:data = data.table(x=-length(coefs)%/%2:length(coefs)%/%2,
1607789170896:y=coefs)
1607789173625:ggplot(data) +
1607789173642:geom_line(aes(x=x, y=y))+
1607789173658:theme_bw()
1607789180698:length(coefs)%/%2:length(coefs)%/%2
1607789192531:-(length(coefs)%/%2):(length(coefs)%/%2)
1607789197819:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789197836:y=coefs)
1607789198083:ggplot(data) +
1607789198100:geom_line(aes(x=x, y=y))+
1607789198118:theme_bw()
1607789209186:coefs <- filter.coef(121, 7)
1607789255633:install.packages("pracma")
1607789268531:library(pracma)
1607789278970:filter.coef <- function(width, order, derivative=0) {
1607789278989:stopifnot(width %% 2 == 1)
1607789279029:# half-width
1607789279046:M <- (width - 1)/2
1607789279065:A <- matrix(0,
1607789279083:nrow=width,
1607789279102:ncol=order)
1607789279129:for (n in 0:(width-1)){
1607789279150:for (i in 0:(order-1)){
1607789279171:A[n+1, i+1] <- (n-M)^i
1607789279187:}
1607789279203:}
1607789279231:H = pinv(t(A) %*% A) %*% t(A)
1607789279253:return(H[derivative+1,]*factorial(derivative))
1607789279287:}
1607789281123:coefs <- filter.coef(121, 7)
1607789282123:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789282140:y=coefs)
1607789282533:ggplot(data) +
1607789282550:geom_line(aes(x=x, y=y))+
1607789282565:theme_bw()
1607789293529:coefs <- filter.coef(61, 12)
1607789293787:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789293802:y=coefs)
1607789294052:ggplot(data) +
1607789294068:geom_line(aes(x=x, y=y))+
1607789294085:theme_bw()
1607789302640:?pinv
1607789314843:.Machine$double.eps^(2/3)
1607789329971:filter.coef <- function(width, order, derivative=0) {
1607789329987:stopifnot(width %% 2 == 1)
1607789330024:# half-width
1607789330039:M <- (width - 1)/2
1607789330059:A <- matrix(0,
1607789330073:nrow=width,
1607789330093:ncol=order)
1607789330118:for (n in 0:(width-1)){
1607789330135:for (i in 0:(order-1)){
1607789330151:A[n+1, i+1] <- (n-M)^i
1607789330166:}
1607789330186:}
1607789330218:H = pinv(t(A) %*% A, tol=1e-40) %*% t(A)
1607789330243:return(H[derivative+1,]*factorial(derivative))
1607789330270:}
1607789331258:coefs <- filter.coef(61, 12)
1607789331866:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789331886:y=coefs)
1607789332027:ggplot(data) +
1607789332045:geom_line(aes(x=x, y=y))+
1607789332063:theme_bw()
1607789340994:coefs <- filter.coef(61, 5)
1607789341387:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789341404:y=coefs)
1607789341547:ggplot(data) +
1607789341563:geom_line(aes(x=x, y=y))+
1607789341581:theme_bw()
1607789346586:coefs <- filter.coef(61, 3)
1607789346756:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789346774:y=coefs)
1607789346923:ggplot(data) +
1607789346940:geom_line(aes(x=x, y=y))+
1607789346961:theme_bw()
1607789352139:coefs <- filter.coef(61, 12)
1607789352291:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789352310:y=coefs)
1607789352435:ggplot(data) +
1607789352454:geom_line(aes(x=x, y=y))+
1607789352470:theme_bw()
1607789358315:H = pinv(t(A) %*% A, tol=1e-80) %*% t(A)
1607789358667:return(H[derivative+1,]*factorial(derivative))
1607789359180:filter.coef <- function(width, order, derivative=0) {
1607789359197:stopifnot(width %% 2 == 1)
1607789359230:# half-width
1607789359245:M <- (width - 1)/2
1607789359262:A <- matrix(0,
1607789359278:nrow=width,
1607789359292:ncol=order)
1607789359316:for (n in 0:(width-1)){
1607789359334:for (i in 0:(order-1)){
1607789359351:A[n+1, i+1] <- (n-M)^i
1607789359370:}
1607789359386:}
1607789359416:H = pinv(t(A) %*% A, tol=1e-80) %*% t(A)
1607789359443:return(H[derivative+1,]*factorial(derivative))
1607789359474:}
1607789360043:```{r}
1607789360205:coefs <- filter.coef(61, 12)
1607789360565:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789360582:y=coefs)
1607789360740:ggplot(data) +
1607789360758:geom_line(aes(x=x, y=y))+
1607789360776:theme_bw()
1607789425306:filter.coef <- function(width, order, derivative=0) {
1607789425326:stopifnot(width %% 2 == 1)
1607789425362:# half-width
1607789425381:M <- (width - 1)/2
1607789425398:A <- matrix(0,
1607789425416:nrow=width,
1607789425433:ncol=order)
1607789425457:for (n in 0:(width-1)){
1607789425476:for (i in 0:(order-1)){
1607789425494:A[n+1, i+1] <- (n-M)^i
1607789425512:}
1607789425529:}
1607789425557:H = solve(t(A) %*% A, tol=1e-80) %*% t(A)
1607789425579:return(H[derivative+1,]*factorial(derivative))
1607789425610:}
1607789427514:coefs <- filter.coef(61, 12)
1607789428057:data = data.table(x=-(length(coefs)%/%2):(length(coefs)%/%2),
1607789428074:y=coefs)
1607789428393:ggplot(data) +
1607789428410:geom_line(aes(x=x, y=y))+
1607789428426:theme_bw()
1607789445362:ggplot(data) +
1607789445378:geom_line(aes(x=x, y=y)) +
1607789445394:geom_hline(yintercept = 0) +
1607789445410:theme_bw()
1607789452770:ggplot(data) +
1607789452786:geom_hline(yintercept = 0) +
1607789452804:geom_line(aes(x=x, y=y)) +
1607789452820:theme_bw()
1607789667033:.blue   = "#4e6678"
1607789667169:.mauve  = "#d46edb"
1607789667331:.orange = "#f27b1f"
1607789667473:.bistre = "#876f5c"
1607789667601:.gray   = "#6b8599"
1607789673985:ggplot(data) +
1607789674004:geom_hline(yintercept = 0, color=.gray) +
1607789674021:geom_line(aes(x=x, y=y)) +
1607789674036:theme_bw()
1607789682027:ggplot(data) +
1607789682044:geom_hline(yintercept = 0, color=.gray) +
1607789682060:geom_line(aes(x=x, y=y), color=.blue) +
1607789682075:theme_bw()
1607789688938:ggplot(data) +
1607789688956:geom_hline(yintercept = 0, color=.gray, alpha=0.1) +
1607789688976:geom_line(aes(x=x, y=y), color=.blue) +
1607789688994:theme_bw()
1607789729601:.blue   = "#1D7C96"
1607789732121:ggplot(data) +
1607789732137:geom_hline(yintercept = 0, color=.gray, alpha=0.1) +
1607789732155:geom_line(aes(x=x, y=y), color=.blue) +
1607789732175:theme_bw()
1607789739608:ggplot(data) +
1607789739626:geom_hline(yintercept = 0, color=.gray, alpha=0.5) +
1607789739643:geom_line(aes(x=x, y=y), color=.blue) +
1607789739661:theme_bw()
1607789822230:filer
1607789823384:filter
1607789825416:?filter
1607789899263:?rep
1607789907699:size <- 100
1607789911632:rep(0, size)
1607789936816:half.size <- 100
1607789979007:generate.impulse.responde <- function(half.size) {
1607789979026:impulse.response <- rep(0, 2*half.size + 1)
1607789979042:impulse.response[half.size+1] <- 1
1607789979058:return(impulse.response)
1607789979075:}
1607789989375:generate.impulse.response <- function(half.size) {
1607789989391:impulse.response <- rep(0, 2*half.size + 1)
1607789989407:impulse.response[half.size+1] <- 1
1607789989421:return(impulse.response)
1607789989440:}
1607789992746:generate.impulse.response(3)
1607790005400:impulse.response <- generate.impulse.response(3)
1607790036278:?filter
1607790043664:filter(impulse.response, coefs, method="convolution")
1607790048464:impulse.response <- generate.impulse.response(100)
1607790048772:filter(impulse.response, coefs, method="convolution")
1607790078984:ggplot(aes(res))
1607790084959:res <- filter(impulse.response, coefs, method="convolution")
1607790085144:ggplot(aes(res)) + geom_line()
1607790111190:library(dplyr)
1607790124857:install.packages("dplyr")
1607790228757:data.frame
1607790259550:data.frame(y=res) %>%
1607790259567:ggplot(., aes(y)) + geom_line()
1607790263983:library(dplyr)
1607790266519:data.frame(y=res) %>%
1607790266541:ggplot(., aes(y)) + geom_line()
1607790336358:rep.like <- function(x) {
1607790336374:return(-(length(x)%/%2):(length(x)%/%2))
1607790336390:}
1607790338718:coefs <- filter.coef(61, 12)
1607790338848:data = data.table(x=rep.like(coefs),
1607790338863:y=coefs)
1607790338993:ggplot(data) +
1607790339011:geom_hline(yintercept = 0, color=.gray, alpha=0.5) +
1607790339031:geom_line(aes(x=x, y=y), color=.blue) +
1607790339051:theme_bw()
1607790343433:generate.impulse.response <- function(half.size) {
1607790343454:impulse.response <- rep(0, 2*half.size + 1)
1607790343474:impulse.response[half.size+1] <- 1
1607790343495:return(impulse.response)
1607790343515:}
1607790343616:impulse.response <- generate.impulse.response(100)
1607790344054:res <- filter(impulse.response, coefs, method="convolution")
1607790366312:library(stats)
1607790369295:res <- filter(impulse.response, coefs, method="convolution")
1607790381270:impulse.response
1607790384302:coes
1607790385925:coefs
1607790388224:res <- stats::filter(impulse.response, coefs, method="convolution")
1607790399766:data.frame(y=res,
1607790399782:x=rep.like(res)) %>%
1607790399801:ggplot(., aes(x, y)) + geom_line()
1607790414421:?filter
1607790439606:res <- stats::filter(impulse.response, coefs, method="convolution", circular=F)
1607790439839:data.frame(y=res,
1607790439855:x=rep.like(res)) %>%
1607790439875:ggplot(., aes(x, y)) + geom_line()
1607790444662:res <- stats::filter(impulse.response, coefs, method="convolution", circular=T)
1607790444863:data.frame(y=res,
1607790444880:x=rep.like(res)) %>%
1607790444899:ggplot(., aes(x, y)) + geom_line()
1607790495703:filter <- function(x, filter) {
1607790495722:x <- stats::filter(x, filter, method="convolution")
1607790495742:return(x[!is.na(x)])
1607790495760:}
1607790502936:res <- filter(impulse.response, coefs, method="convolution")
1607790506214:data.frame(y=res,
1607790506231:x=rep.like(res)) %>%
1607790506250:ggplot(., aes(x, y)) + geom_line()
1607790510757:res <- filter(impulse.response, coefs)
1607790511231:data.frame(y=res,
1607790511249:x=rep.like(res)) %>%
1607790511264:ggplot(., aes(x, y)) + geom_line()
1607790515198:res
1607790528503:stats::filter(x, filter, method="convolution")
1607790550021:#res <- filter(impulse.response, coefs)
1607790550037:res <- stats::filter(impulse.response, coefs, method="convolution")
1607790551268:res
1607790555382:res[!is.na(res)]
1607790558161:res
1607790632367:fft(res)
1607790637502:res <- filter(impulse.response, coefs)
1607790639357:fft(res)
1607790652244:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790652261:res <- abs(fft(res))
1607790652720:data.frame(y=res,
1607790652736:x=rep.like(res)) %>%
1607790652757:ggplot(., aes(x, y)) + geom_line()
1607790674972:res <- filter(impulse.response, coefs)
1607790675087:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790675104:res <- log10(abs(fft(res)))
1607790675510:data.frame(y=res,
1607790675527:x=rep.like(res)) %>%
1607790675545:ggplot(., aes(x, y)) + geom_line()
1607790684278:coefs <- filter.coef(61, 3)
1607790684550:data = data.table(x=rep.like(coefs),
1607790684567:y=coefs)
1607790684752:ggplot(data) +
1607790684771:geom_hline(yintercept = 0, color=.gray, alpha=0.5) +
1607790684789:geom_line(aes(x=x, y=y), color=.blue) +
1607790684805:theme_bw()
1607790685613:```{r}
1607790686101:generate.impulse.response <- function(half.size) {
1607790686121:impulse.response <- rep(0, 2*half.size + 1)
1607790686141:impulse.response[half.size+1] <- 1
1607790686158:return(impulse.response)
1607790686174:}
1607790687971:impulse.response <- generate.impulse.response(100)
1607790688143:res <- filter(impulse.response, coefs)
1607790688641:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790688660:res <- log10(abs(fft(res)))
1607790689231:data.frame(y=res,
1607790689250:x=rep.like(res)) %>%
1607790689268:ggplot(., aes(x, y)) + geom_line()
1607790719701:res <- filter(impulse.response, coefs)
1607790726462:res <- res[res != 0]
1607790727103:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790727123:res <- log10(abs(fft(res)))
1607790727254:data.frame(y=res,
1607790727272:x=rep.like(res)) %>%
1607790727289:ggplot(., aes(x, y)) + geom_line()
1607790745011:impulse.response <- generate.impulse.response(100)
1607790745385:coefs <- filter.coef(121, 3)
1607790745728:res <- filter(impulse.response, coefs)
1607790745926:res <- res[res != 0]
1607790746087:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790746105:res <- log10(abs(fft(res)))
1607790746349:data.frame(y=res,
1607790746366:x=rep.like(res)) %>%
1607790746385:ggplot(., aes(x, y)) + geom_line()
1607790813932:res <- filter(impulse.response, coefs)
1607790814086:res <- res[res != 0]
1607790814238:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790814255:res <- log10(abs(mvfft(res)))
1607790814988:data.frame(y=res,
1607790815003:x=rep.like(res)) %>%
1607790815020:ggplot(., aes(x, y)) + geom_line()
1607790821750:res <- filter(impulse.response, coefs)
1607790821894:res <- res[res != 0]
1607790822044:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790822061:res <- log10(abs(fft(res)))
1607790822192:data.frame(y=res,
1607790822210:x=rep.like(res)) %>%
1607790822226:ggplot(., aes(x, y)) + geom_line()
1607790832725:coefs <- filter.coef(121, 4)
1607790832912:res <- filter(impulse.response, coefs)
1607790833052:res <- res[res != 0]
1607790833205:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607790833228:res <- log10(abs(fft(res)))
1607790833364:data.frame(y=res,
1607790833384:x=rep.like(res)) %>%
1607790833402:ggplot(., aes(x, y)) + geom_line()
1607790837292:res
1607790906475:install.packages("spectral")
1607791052342:spectrum
1607791057483:sprectrum(res)
1607791061707:spectrum(res)
1607791072963:?spectrum
1607791079758:res
1607791084304:impulse.response <- generate.impulse.response(1000)
1607791084583:coefs <- filter.coef(121, 4)
1607791084864:res <- filter(impulse.response, coefs)
1607791085053:res <- res[res != 0]
1607791085244:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607791085262:res <- log10(abs(fft(res)))
1607791085483:data.frame(y=res,
1607791085499:x=rep.like(res)) %>%
1607791085515:ggplot(., aes(x, y)) + geom_line()
1607791093494:res <- filter(impulse.response, coefs)
1607791093652:res <- res[res != 0]
1607791099259:spectrum(res)
1607791111548:impulse.response <- generate.impulse.response(4000)
1607791112204:coefs <- filter.coef(121, 4)
1607791112846:res <- filter(impulse.response, coefs)
1607791113044:res <- res[res != 0]
1607791113549:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607791113566:#res <- log10(abs(fft(res)))
1607791113584:data.frame(y=res,
1607791113602:x=rep.like(res)) %>%
1607791113621:ggplot(., aes(x, y)) + geom_line()
1607791120364:spectrum(res)
1607791225603:impulse.response <- generate.impulse.response(20)
1607791225860:coefs <- filter.coef(15, 1)
1607791227662:res <- filter(impulse.response, coefs)
1607791230564:res
1607791246588:fft(res)
1607791262010:res
1607791275820:res
1607791314637:impulse.response <- generate.impulse.response(27)
1607791314790:coefs <- filter.coef(15, 1)
1607791315090:#res <- filter(impulse.response, coefs)
1607791315110:#res <- res[res != 0]
1607791315129:res <- stats::filter(impulse.response, coefs, method="convolution")
1607791316842:res
1607791333717:fft(res)
1607791346322:filter <- function(x, filter) {
1607791346340:x <- stats::filter(x, filter, method="convolution")
1607791346357:x[is.na(x)] <- 0
1607791346373:return(x)
1607791346389:}
1607791348651:generate.impulse.response <- function(half.size) {
1607791348667:impulse.response <- rep(0, 2*half.size + 1)
1607791348683:impulse.response[half.size+1] <- 1
1607791348701:return(impulse.response)
1607791348718:}
1607791348799:impulse.response <- generate.impulse.response(27)
1607791349092:coefs <- filter.coef(15, 1)
1607791349564:#res <- filter(impulse.response, coefs)
1607791349581:#res <- res[res != 0]
1607791349597:res <- stats::filter(impulse.response, coefs, method="convolution")
1607791356748:res <- filter(impulse.response, coefs)
1607791358442:res
1607791362549:fft(res)
1607791374261:res
1607791379147:res %>% length
1607791391795:impulse.response <- generate.impulse.response(20)
1607791392275:coefs <- filter.coef(15, 1)
1607791392730:res <- filter(impulse.response, coefs)
1607791395260:res %>% length
1607791421082:fft(res)
1607791425350:fft(res, inverse=T)
1607791429363:fft(res)
1607791506090:#res <- res[res != 0]
1607791506108:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607791506129:res <- log10(abs(fft(res)))
1607791506332:data.frame(y=res,
1607791506350:x=rep.like(res)) %>%
1607791506370:ggplot(., aes(x, y)) + geom_line()
1607791514892:impulse.response <- generate.impulse.response(2000)
1607791515067:coefs <- filter.coef(15, 1)
1607791515220:res <- filter(impulse.response, coefs)
1607791515370:#res <- res[res != 0]
1607791515387:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607791515402:res <- log10(abs(fft(res)))
1607791515530:data.frame(y=res,
1607791515548:x=rep.like(res)) %>%
1607791515567:ggplot(., aes(x, y)) + geom_line()
1607791794551:length(res)
1607791838739:.res <- res[:2000]
1607791841507:.res <- res[1:2000]
1607791841933:data.frame(y=.res,
1607791841952:x=rep.like(.res)) %>%
1607791841971:ggplot(., aes(x, y)) + geom_line()
1607791850172:.res <- res[1:2000]
1607791853513:..res
1607791855395:.res
1607791859361:.res %>% length
1607791865000:data.frame(y=.res,
1607791865018:x=rep.like(.res))
1607791876882:data.frame(y=.res,
1607791876899:x=1:2000) %>%
1607791876917:ggplot(., aes(x, y)) + geom_line()
1607791889286:data.frame(y=.res,
1607791889305:x=1:2001) %>%
1607791889325:ggplot(., aes(x, y)) + geom_line()
1607791893658:.res <- res[1:2001]
1607791893792:data.frame(y=.res,
1607791893809:x=1:2001) %>%
1607791893825:ggplot(., aes(x, y)) + geom_line()
1607791898969:.res
1607791910496:res[1998:2002]
1607792031856:library(spectral)
1607792039586:res <- filter(impulse.response, coefs)
1607792041664:spec.fft(res)
1607792046033:res
1607792303103:spec.fft(res)
1607792374337:res
1607792396455:res
1607792405864:a <- c(1,2,3,4,5,6)
1607792407974:a[1:2]
1607792538216:7 %/% 2
1607792566115:if (l %% 2 == 0){
1607792566135:return(c(x[(l%/%2+1):l],x[1:(l%/%2)]))
1607792566154:} else{
1607792566170:return(c(x[(l%/%2+2):l],x[l%/%2+1], x[1:(l%/%2)]))
1607792566185:}
1607792569639:fftshift <- function(x) {
1607792569656:l <- length(x)
1607792569674:if (l %% 2 == 0){
1607792569692:return(c(x[(l%/%2+1):l],x[1:(l%/%2)]))
1607792569710:} else{
1607792569729:return(c(x[(l%/%2+2):l],x[l%/%2+1], x[1:(l%/%2)]))
1607792569745:}
1607792569769:}
1607792576792:fftshift <- function(x) {
1607792576810:l <- length(x)
1607792576829:if (l %% 2 == 0){
1607792576847:return(c(x[(l%/%2+1):l],x[1:(l%/%2)]))
1607792576864:}
1607792576882:return(c(x[(l%/%2+2):l],x[l%/%2+1], x[1:(l%/%2)]))
1607792576899:}
1607792583944:fftshift(c(1,2,3,4,5))
1607792605608:res <- filter(impulse.response, coefs)
1607792606494:#res <- res[res != 0]
1607792606511:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607792606527:res <- log10(abs(fft(res)))
1607792620568:data.frame(y=fftshift(res),
1607792627511:)
1607792630222:data.frame(y=fftshift(res),
1607792630241:x=rep.like(res)) %>%
1607792630261:ggplot(., aes(x, y)) + geom_line()
1607792649501:fftshift <- function(x) {
1607792649519:l <- length(x)
1607792649543:return(c(x[(l%/%2+1):l],x[1:(l%/%2)]))
1607792649568:#return(c(x[(l%/%2+2):l],x[l%/%2+1], x[1:(l%/%2)]))
1607792649588:}
1607792651973:data.frame(y=fftshift(res),
1607792651990:x=rep.like(res)) %>%
1607792652009:ggplot(., aes(x, y)) + geom_line()
1607792857066:fftfreq <- function(n, d) {
1607792857090:if (n %/% 2 == 0) {
1607792857107:return(c(
1607792857126:0:(n/2-1),
1607792857143:(-n/2):-1))
1607792857161:}
1607792857185:return(c(
1607792857200:0:((n-1)/2),
1607792857217:(-(n-1)/2:-1)
1607792857235:))
1607792857253:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607792857269:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607792857284:}
1607792910604:fftshift(8, 0.1)
1607792921212:fftfreq(8, 0.1)
1607792987726:n = 8
1607792992559:c(
1607792992578:0:(n/2-1),
1607792992596:(-n/2):-1)
1607793009606:fftfreq <- function(n, d) {
1607793009629:if (n %/% 2 == 0) {
1607793009645:print("ok")
1607793009661:return(c(
1607793009677:0:(n/2-1),
1607793009696:(-n/2):-1))
1607793009712:}
1607793009737:return(c(
1607793009755:0:((n-1)/2),
1607793009771:(-(n-1)/2:-1)
1607793009787:))
1607793009803:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607793009819:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607793009838:}
1607793011876:fftfreq(8, 0.1)
1607793021765:n %/% 2
1607793025380:fftfreq <- function(n, d) {
1607793025405:if (n %% 2 == 0) {
1607793025424:print("ok")
1607793025443:return(c(
1607793025459:0:(n/2-1),
1607793025475:(-n/2):-1))
1607793025491:}
1607793025517:return(c(
1607793025537:0:((n-1)/2),
1607793025555:(-(n-1)/2:-1)
1607793025576:))
1607793025597:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607793025618:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607793025641:}
1607793030411:fftfreq(8, 0.1)
1607793057990:fftfreq <- function(n, d) {
1607793058015:if (n %% 2 == 0) {
1607793058037:return(c(
1607793058052:0:(n/2-1),
1607793058068:(-n/2):-1) / (d*n))
1607793058083:}
1607793058104:return(c(
1607793058118:0:((n-1)/2),
1607793058134:(-(n-1)/2:-1)
1607793058149:)/(d*n))
1607793058165:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607793058180:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607793058195:}
1607793075705:data.frame(y=fftshift(res),
1607793075722:x=fft.shift(length(res))) %>%
1607793075740:ggplot(., aes(x, y)) + geom_line()
1607793081523:data.frame(y=fftshift(res),
1607793081540:x=fftfreq(length(res))) %>%
1607793081560:ggplot(., aes(x, y)) + geom_line()
1607793089109:data.frame(y=fftshift(res),
1607793089126:x=fftfreq(length(res), d=0.1)) %>%
1607793089145:ggplot(., aes(x, y)) + geom_line()
1607793094989:res
1607793101996:length(res)
1607793106695:fftfreq(length(res), d=0.1)
1607793111588:fftfreq(length(res), d=0.1) %>% length
1607793127997:fftfreq(8, 0.1)
1607793135837:fftfreq(9, 0.1)
1607793198174:return(c(
1607793198191:0:((n-1)/2),
1607793198210:(-(n-1)/2):-1
1607793198228:)/(d*n))
1607793200324:fftfreq <- function(n, d) {
1607793200350:if (n %% 2 == 0) {
1607793200376:return(c(
1607793200396:0:(n/2-1),
1607793200415:(-n/2):-1) / (d*n))
1607793200437:}
1607793200464:return(c(
1607793200483:0:((n-1)/2),
1607793200503:(-(n-1)/2):-1
1607793200525:)/(d*n))
1607793200543:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607793200561:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607793200577:}
1607793202652:fftfreq(9, 0.1)
1607793211692:data.frame(y=fftshift(res),
1607793211711:x=fftfreq(length(res), d=0.1)) %>%
1607793211730:ggplot(., aes(x, y)) + geom_line()
1607793220244:data.frame(y=res,
1607793220263:x=fftfreq(length(res), d=0.1)) %>%
1607793220282:ggplot(., aes(x, y)) + geom_line()
1607793233955:data.frame(y=res,
1607793233971:x=fftfreq(length(res), d=1)) %>%
1607793233988:ggplot(., aes(x, y)) + geom_line()
1607793545506:res
1607793564819:data.frame(y=res,
1607793564836:x=fftfreq(length(res), d=1)) %>%
1607793564855:ggplot(., aes(x, y), color=.blue) + geom_line() +
1607793564891:```
1607793567685:data.frame(y=res,
1607793567703:x=fftfreq(length(res), d=1)) %>%
1607793567720:ggplot(., aes(x, y), color=.blue) + geom_line()
1607793576548:data.frame(y=res,
1607793576566:x=fftfreq(length(res), d=1)) %>%
1607793576585:ggplot(., aes(x, y)) + geom_line(color=.blue)
1607793587162:data.frame(y=res,
1607793587180:x=fftfreq(length(res), d=1)) %>%
1607793587199:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793587216:theme_economist_white()
1607793592971:data.frame(y=res,
1607793592988:x=fftfreq(length(res), d=1)) %>%
1607793593006:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793593024:theme_economist()
1607793607789:data.frame(y=res,
1607793607809:x=fftfreq(length(res), d=1)) %>%
1607793607828:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793607848:theme_excel()
1607793612705:data.frame(y=res,
1607793612723:x=fftfreq(length(res), d=1)) %>%
1607793612739:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793612755:theme_excel_new()
1607793627186:data.frame(y=res,
1607793627204:x=fftfreq(length(res), d=1)) %>%
1607793627221:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793627238:theme_pander()
1607793640579:data.frame(y=res,
1607793640597:x=fftfreq(length(res), d=1)) %>%
1607793640617:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793640634:theme_foundation()
1607793656852:data.frame(y=res,
1607793656872:x=fftfreq(length(res), d=1)) %>%
1607793656889:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793656906:theme_wsj()
1607793668979:data.frame(y=res,
1607793668996:x=fftfreq(length(res), d=1)) %>%
1607793669012:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793669029:theme_excel_new()
1607793675673:data.frame(y=res,
1607793675691:x=fftfreq(length(res), d=1)) %>%
1607793675709:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793675725:theme_bw()
1607793681196:data.frame(y=res,
1607793681213:x=fftfreq(length(res), d=1)) %>%
1607793681230:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793681246:theme_excel_new()
1607793687635:data.frame(y=res,
1607793687652:x=fftfreq(length(res), d=1)) %>%
1607793687670:ggplot(., aes(x, y)) + geom_line(color=.blue) +
1607793687689:theme_pander()
1607793710043:geom_line(color=.blue) +
1607793710062:theme_pander()
1607793714533:data.frame(y=res,
1607793714553:x=fftfreq(length(res), d=1)) %>%
1607793714571:ggplot(., aes(x, y)) +
1607793714588:geom_hline(yintercept=0, color=.gray) +
1607793714604:geom_line(color=.blue) +
1607793714620:theme_pander()
1607793725690:data.frame(y=res,
1607793725706:x=fftfreq(length(res), d=1)) %>%
1607793725722:ggplot(., aes(x, y)) +
1607793725737:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607793725754:geom_line(color=.blue) +
1607793725771:theme_pander()
1607794202303:widths <- 1:100:10
1607794202445:orders <- 1:12:2
1607794202603:impulse.response <- generate.impulse.response(2000)
1607794202900:dt <- data.table()
1607794203225:for (width in widths) {
1607794203242:for (order in orders) {
1607794203266:coefs <- filter.coef(width=width, order=order)
1607794203285:res <- filter(impulse.response, coefs)
1607794203301:res.log <- log10(abs(fft(res)))
1607794203319:freqs <- fftfreq(length(res), d=1)
1607794203345:dt <- rbind(dt,
1607794203363:data.table(y=res.log,
1607794203381:freq=freqs))
1607794203402:}
1607794203420:}
1607794208080:d
1607794210329:order
1607794210800:w
1607794212752:width
1607794284913:order <- 3
1607794285385:for (width in widths[widths > order*2]) {
1607794285403:coefs <- filter.coef(width=width, order=order)
1607794285420:res <- filter(impulse.response, coefs)
1607794285436:res.log <- log10(abs(fft(res)))
1607794285453:freqs <- fftfreq(length(res), d=1)
1607794285477:dt <- rbind(dt,
1607794285493:data.table(y=res.log,
1607794285509:freq=freqs))
1607794285525:}
1607794303825:1:100:6
1607794321643:widths <- seq(1, 100, 10)
1607794321794:orders <- seq(1, 12, 2)
1607794322312:impulse.response <- generate.impulse.response(2000)
1607794322883:dt <- data.table()
1607794323298:order <- 3
1607794323973:for (width in widths[widths > order*2]) {
1607794323994:coefs <- filter.coef(width=width, order=order)
1607794324013:res <- filter(impulse.response, coefs)
1607794324033:res.log <- log10(abs(fft(res)))
1607794324052:freqs <- fftfreq(length(res), d=1)
1607794324078:dt <- rbind(dt,
1607794324097:data.table(y=res.log,
1607794324116:freq=freqs))
1607794324135:}
1607794326482:dt
1607794343482:for (width in widths[widths > order*2]) {
1607794343501:coefs <- filter.coef(width=width, order=order)
1607794343521:res <- filter(impulse.response, coefs)
1607794343539:res.log <- log10(abs(fft(res)))
1607794343556:freqs <- fftfreq(length(res), d=1)
1607794343580:dt <- rbind(dt,
1607794343599:data.table(y=res.log,
1607794343618:freq=freqs,
1607794343637:width=width))
1607794343655:}
1607794353201:order <- 3
1607794353345:dt <- data.table()
1607794353545:for (width in widths[widths > order*2]) {
1607794353563:coefs <- filter.coef(width=width, order=order)
1607794353580:res <- filter(impulse.response, coefs)
1607794353598:res.log <- log10(abs(fft(res)))
1607794353614:freqs <- fftfreq(length(res), d=1)
1607794353641:dt <- rbind(dt,
1607794353658:data.table(y=res.log,
1607794353677:freq=freqs,
1607794353695:width=width))
1607794353713:}
1607794355304:dt
1607794379281:ggplot(dt, aes(freq, y, color=width)) +
1607794379299:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794379315:geom_line() +
1607794379333:theme_pander()
1607794398393:dt[, unique(width)]
1607794408825:widths <- seq(1, 100, 30)
1607794411216:dt <- data.table()
1607794411368:for (width in widths[widths > order*2]) {
1607794411384:coefs <- filter.coef(width=width, order=order)
1607794411404:res <- filter(impulse.response, coefs)
1607794411423:res.log <- log10(abs(fft(res)))
1607794411440:freqs <- fftfreq(length(res), d=1)
1607794411467:dt <- rbind(dt,
1607794411487:data.table(y=res.log,
1607794411505:freq=freqs,
1607794411523:width=width))
1607794411542:}
1607794412019:ggplot(dt, aes(freq, y, color=width)) +
1607794412036:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794412054:geom_line() +
1607794412074:theme_pander()
1607794430330:ggplot(dt, aes(freq, y, color=width)) +
1607794430349:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794430368:geom_line() +
1607794430385:theme_pander() +
1607794430400:scale_color_brewer()
1607794443573:for (width in widths[widths > order*2]) {
1607794443591:coefs <- filter.coef(width=width, order=order)
1607794443607:res <- filter(impulse.response, coefs)
1607794443625:res.log <- log10(abs(fft(res)))
1607794443644:freqs <- fftfreq(length(res), d=1)
1607794443667:dt <- rbind(dt,
1607794443684:data.table(y=res.log,
1607794443703:freq=freqs,
1607794443721:width=as.factor(width)))
1607794443740:}
1607794444479:ggplot(dt, aes(freq, y, color=width)) +
1607794444497:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794444517:geom_line() +
1607794444533:theme_pander() +
1607794444553:scale_color_brewer()
1607794457105:ggplot(dt, aes(freq, y, color=width)) +
1607794457123:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794457143:geom_line() +
1607794457162:theme_pander() +
1607794457179:scale_color_canva()
1607794469768:?scale_color_canva
1607794547537:ggplot(dt, aes(freq, y, color=width)) +
1607794547558:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794547577:geom_line() +
1607794547595:theme_pander() +
1607794547613:scale_color_canvas(palette = "Subdued & Professional")
1607794555441:ggplot(dt, aes(freq, y, color=width)) +
1607794555459:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794555475:geom_line() +
1607794555498:theme_pander() +
1607794555516:scale_color_canva(palette = "Subdued & Professional")
1607794562706:ggplot(dt, aes(freq, y, color=width)) +
1607794562724:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794562743:geom_line() +
1607794562761:theme_pander() +
1607794562779:scale_color_canva(palette = "Subdued and Professional")
1607794575103:canva_palettes()
1607794587317:canva_palettes
1607794600143:names(canva_palettes)[1]
1607794605423:ggplot(dt, aes(freq, y, color=width)) +
1607794605441:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794605460:geom_line() +
1607794605477:theme_pander() +
1607794605495:scale_color_canva(palette = names(canva_palettes)[2])
1607794611649:ggplot(dt, aes(freq, y, color=width)) +
1607794611668:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794611685:geom_line() +
1607794611703:theme_pander() +
1607794611720:scale_color_canva(palette = names(canva_palettes)[3])
1607794617351:ggplot(dt, aes(freq, y, color=width)) +
1607794617367:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794617382:geom_line() +
1607794617400:theme_pander() +
1607794617417:scale_color_canva(palette = names(canva_palettes)[2])
1607794678246:ggplot(dt[freq>0], aes(freq, y, color=width)) +
1607794678264:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794678282:geom_line() +
1607794678301:theme_pander() +
1607794678319:scale_color_canva(palette = names(canva_palettes)[2])
1607794858882:for (order in orders){
1607794858899:for (width in widths[widths > order*2]) {
1607794858918:coefs <- filter.coef(width=width, order=order)
1607794858934:res <- filter(impulse.response, coefs)
1607794858952:res.log <- log10(abs(fft(res)))
1607794858971:freqs <- fftfreq(length(res), d=1)
1607794858995:dt <- rbind(dt,
1607794859014:data.table(y=res.log,
1607794859032:freq=freqs,
1607794859048:width = as.factor(width),
1607794859065:order = as.factor(order)))
1607794859083:}
1607794859108:}
1607794859149:ggplot(dt[freq>0], aes(freq, y, color=width)) +
1607794859168:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794859186:geom_line() +
1607794859202:theme_pander() +
1607794859220:scale_color_canva(palette = names(canva_palettes)[2])
1607794866928:order <- 3
1607794867083:dt <- data.table()
1607794869615:widths <- seq(1, 100, 30)
1607794869764:orders <- seq(1, 12, 2)
1607794870761:impulse.response <- generate.impulse.response(2000)
1607794871216:dt <- data.table()
1607794871367:for (order in orders){
1607794871385:for (width in widths[widths > order*2]) {
1607794871405:coefs <- filter.coef(width=width, order=order)
1607794871423:res <- filter(impulse.response, coefs)
1607794871441:res.log <- log10(abs(fft(res)))
1607794871460:freqs <- fftfreq(length(res), d=1)
1607794871484:dt <- rbind(dt,
1607794871502:data.table(y=res.log,
1607794871521:freq=freqs,
1607794871539:width = as.factor(width),
1607794871558:order = as.factor(order)))
1607794871576:}
1607794871601:}
1607794873062:ggplot(dt[freq>0], aes(freq, y, color=width)) +
1607794873083:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794873101:geom_line() +
1607794873118:theme_pander() +
1607794873136:scale_color_canva(palette = names(canva_palettes)[2])
1607794887823:ggplot(dt[(freq>0) & (order == 2)], aes(freq, y, color=width)) +
1607794887842:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794887860:geom_line() +
1607794887877:theme_pander() +
1607794887894:scale_color_canva(palette = names(canva_palettes)[2])
1607794892152:ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607794892171:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794892190:geom_line() +
1607794892207:theme_pander() +
1607794892224:scale_color_canva(palette = names(canva_palettes)[2])
1607794914502:ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607794914520:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794914537:geom_line() +
1607794914554:theme_pander() +
1607794914569:scale_color_canva(palette = names(canva_palettes)[2])
1607794955248:ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=as.numeric(order))) +
1607794955264:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794955284:geom_line() +
1607794955302:theme_pander() +
1607794955321:scale_color_canva(palette = names(canva_palettes)[2])
1607794990018:ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=as.numeric(order))) +
1607794990039:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794990058:geom_line() +
1607794990078:theme_pander() +
1607794990096:scale_color_canva(palette = names(canva_palettes)[2])
1607794998040:ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607794998056:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607794998073:geom_line() +
1607794998090:theme_pander() +
1607794998109:scale_color_canva(palette = names(canva_palettes)[2])
1607795024490:widths <- seq(1, 100, 30)
1607795024647:orders <- seq(1, 8, 2)
1607795024799:impulse.response <- generate.impulse.response(2000)
1607795025095:dt <- data.table()
1607795025614:for (order in orders){
1607795025634:for (width in widths[widths > order*2]) {
1607795025651:coefs <- filter.coef(width=width, order=order)
1607795025671:res <- filter(impulse.response, coefs)
1607795025686:res.log <- log10(abs(fft(res)))
1607795025707:freqs <- fftfreq(length(res), d=1)
1607795025735:dt <- rbind(dt,
1607795025755:data.table(y=res.log,
1607795025773:freq=freqs,
1607795025793:width = as.factor(width),
1607795025810:order = as.factor(order)))
1607795025829:}
1607795025853:}
1607795027966:ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795027986:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795028004:geom_line() +
1607795028021:theme_pander() +
1607795028038:scale_color_canva(palette = names(canva_palettes)[2])
1607795032821:ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795032839:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795032856:geom_line() +
1607795032873:theme_pander() +
1607795032889:scale_color_canva(palette = names(canva_palettes)[2])
1607795128509:expression
1607795132636:expression(alpha)
1607795144233:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795144251:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795144269:geom_line() +
1607795144289:theme_pander() +
1607795144306:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795144322:scale_x_continuous(name=expression(alpha))
1607795146662:g.widths
1607795179556:ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795179573:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795179589:geom_line() +
1607795179606:theme_pander() +
1607795179622:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795179639:scale_x_continuous(name=paste0(expression(alpha), " teste"))
1607795218900:ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795218918:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795218935:geom_line() +
1607795218952:theme_pander() +
1607795218969:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795218984:scale_x_continuous(name=expression(alpha"/teste"))
1607795226117:ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795226135:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795226154:geom_line() +
1607795226173:theme_pander() +
1607795226190:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795226206:scale_x_continuous(name=expression(alpha"/teste")))
1607795235079:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795235097:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795235116:geom_line() +
1607795235136:theme_pander() +
1607795235153:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795235172:scale_x_continuous(name=expression(alpha*"/teste"))
1607795237734:g.widths
1607795254669:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795254691:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795254711:geom_line() +
1607795254730:theme_pander() +
1607795254748:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795254766:scale_x_continuous(name=expression(omega*"/2"*pi))
1607795255109:g.widths
1607795288494:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795288511:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795288527:geom_line() +
1607795288547:theme_pander() +
1607795288566:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795288583:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795288600:scale_y_continuous(name="Logaritmo da magnitude")
1607795288772:g.widths
1607795298806:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795298823:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795298841:geom_line() +
1607795298859:theme_pander() +
1607795298878:scale_color_canva(palette = names(canva_palettes)[2]) +
1607795298897:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795298915:scale_y_continuous(name="Logaritmo da magnitude")
1607795316634:arrangeGrob(g.width, g.orders, nrow=2)
1607795320757:??arrangeGrob
1607795350364:library(grid)
1607795375300:install.packages("gridExtra")
1607795407845:library(gridExtra)
1607795412140:arrangeGrob(g.width, g.orders, nrow=2)
1607795416232:arrangeGrob(g.widths, g.orders, nrow=2)
1607795421421:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795445817:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795445835:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795445853:geom_line() +
1607795445869:theme_pander() +
1607795445888:scale_color_canva(palette = names(canva_palettes)[3]) +
1607795445903:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795445925:scale_y_continuous(name="Logaritmo da magnitude")
1607795446049:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795493287:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795493303:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795493321:geom_line() +
1607795493340:theme_pander() +
1607795493361:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795493377:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795493393:scale_y_continuous(name="Logaritmo da magnitude")
1607795493524:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795493541:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795493557:geom_line() +
1607795493575:theme_pander() +
1607795493590:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795493605:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795493622:scale_y_continuous(name="Logaritmo da magnitude")
1607795493901:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795570348:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795570368:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795570387:geom_hline(yintercept=-3, color=.gray, alpha=0.8) +
1607795570407:geom_line() +
1607795570425:theme_pander() +
1607795570446:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795570462:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795570483:scale_y_continuous(name="Logaritmo da magnitude")
1607795570624:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795570645:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795570665:geom_line() +
1607795570685:theme_pander() +
1607795570705:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795570720:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795570738:scale_y_continuous(name="Logaritmo da magnitude")
1607795573997:g.widths
1607795592456:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795592477:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795592496:geom_hline(yintercept=-3, color="black", alpha=0.8) +
1607795592514:geom_line() +
1607795592534:theme_pander() +
1607795592552:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795592571:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795592591:scale_y_continuous(name="Logaritmo da magnitude")
1607795595069:g.widths
1607795606601:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795606622:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795606640:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795606656:geom_line() +
1607795606675:theme_pander() +
1607795606691:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795606708:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795606726:scale_y_continuous(name="Logaritmo da magnitude")
1607795606753:g.widths
1607795640278:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795640296:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795640311:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795640335:geom_line() +
1607795640359:theme_pander() +
1607795640374:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795640390:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795640406:scale_y_continuous(name="Logaritmo da magnitude")
1607795640551:g.widths
1607795657968:g.widths
1607795658204:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795658220:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795658237:geom_line() +
1607795658256:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795658274:theme_pander() +
1607795658293:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795658311:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795658329:scale_y_continuous(name="Logaritmo da magnitude")
1607795672868:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795672888:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795672906:geom_line() +
1607795672925:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795672943:theme_pander() +
1607795672961:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795672977:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795672995:scale_y_continuous(name="Logaritmo da magnitude")
1607795679125:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795781708:widths <- seq(1, 100, 30)
1607795781728:orders <- seq(1, 8, 2)
1607795781746:impulse.response <- generate.impulse.response(2000)
1607795781784:dt <- data.table()
1607795781803:for (order in orders){
1607795781821:for (width in widths[widths > order*2]) {
1607795781841:coefs <- filter.coef(width=width, order=order, derivative=1)
1607795781862:res <- filter(impulse.response, coefs)
1607795781880:res.log <- log10(abs(fft(res)))
1607795781899:freqs <- fftfreq(length(res), d=1)
1607795781925:dt <- rbind(dt,
1607795781942:data.table(y=res.log,
1607795781961:freq=freqs,
1607795781979:width = as.factor(width),
1607795781995:order = as.factor(order)))
1607795782013:}
1607795782039:}
1607795782229:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795782245:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795782261:geom_line() +
1607795782280:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795782298:theme_pander() +
1607795782316:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795782333:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795782351:scale_y_continuous(name="Logaritmo da magnitude")
1607795782384:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795782402:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795782419:geom_line() +
1607795782436:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795782452:theme_pander() +
1607795782469:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795782485:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795782502:scale_y_continuous(name="Logaritmo da magnitude")
1607795782534:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795788239:freq
1607795793909:dt
1607795796307:widths <- seq(1, 100, 30)
1607795796454:orders <- seq(1, 8, 2)
1607795796623:impulse.response <- generate.impulse.response(2000)
1607795798032:dt <- data.table()
1607795798262:for (order in orders){
1607795798282:for (width in widths[widths > order*2]) {
1607795798302:coefs <- filter.coef(width=width, order=order, derivative=1)
1607795798319:res <- filter(impulse.response, coefs)
1607795798336:res.log <- log10(abs(fft(res)))
1607795798354:freqs <- fftfreq(length(res), d=1)
1607795798377:dt <- rbind(dt,
1607795798397:data.table(y=res.log,
1607795798417:freq=freqs,
1607795798435:width = as.factor(width),
1607795798451:order = as.factor(order)))
1607795798468:}
1607795798490:}
1607795821125:orders <- seq(3, 10, 2)
1607795821788:impulse.response <- generate.impulse.response(2000)
1607795822349:dt <- data.table()
1607795822708:for (order in orders){
1607795822727:for (width in widths[widths > order*2]) {
1607795822744:coefs <- filter.coef(width=width, order=order, derivative=1)
1607795822764:res <- filter(impulse.response, coefs)
1607795822782:res.log <- log10(abs(fft(res)))
1607795822799:freqs <- fftfreq(length(res), d=1)
1607795822827:dt <- rbind(dt,
1607795822847:data.table(y=res.log,
1607795822867:freq=freqs,
1607795822883:width = as.factor(width),
1607795822900:order = as.factor(order)))
1607795822920:}
1607795822948:}
1607795824292:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795824311:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795824332:geom_line() +
1607795824355:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795824374:theme_pander() +
1607795824391:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795824408:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795824424:scale_y_continuous(name="Logaritmo da magnitude")
1607795824835:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795824852:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795824868:geom_line() +
1607795824886:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795824907:theme_pander() +
1607795824926:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795824944:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795824961:scale_y_continuous(name="Logaritmo da magnitude")
1607795825233:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795855443:?rep
1607795863284:?seq
1607795887998:widths <- seq(1, 300, 90)
1607795888175:orders <- seq(3, 10, 2)
1607795888340:impulse.response <- generate.impulse.response(2000)
1607795889596:dt <- data.table()
1607795889948:for (order in orders){
1607795889968:for (width in widths[widths > order*2]) {
1607795889985:coefs <- filter.coef(width=width, order=order, derivative=1)
1607795890004:res <- filter(impulse.response, coefs)
1607795890021:res.log <- log10(abs(fft(res)))
1607795890040:freqs <- fftfreq(length(res), d=1)
1607795890063:dt <- rbind(dt,
1607795890079:data.table(y=res.log,
1607795890096:freq=freqs,
1607795890113:width = as.factor(width),
1607795890131:order = as.factor(order)))
1607795890147:}
1607795890170:}
1607795890439:g.widths <- ggplot(dt[(freq>0) & (order == 3)], aes(freq, y, color=width)) +
1607795890467:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795890497:geom_line() +
1607795890526:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795890543:theme_pander() +
1607795890560:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607795890576:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795890592:scale_y_continuous(name="Logaritmo da magnitude")
1607795890836:g.orders <- ggplot(dt[(freq>0) & (width == 31)], aes(freq, y, color=order)) +
1607795890855:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795890874:geom_line() +
1607795890895:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795890915:theme_pander() +
1607795890931:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795890947:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795890964:scale_y_continuous(name="Logaritmo da magnitude")
1607795891131:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795947666:g.orders <- ggplot(dt[(freq>0) & (width == widths[1])], aes(freq, y, color=order)) +
1607795947688:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607795947706:geom_line() +
1607795947722:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607795947743:theme_pander() +
1607795947762:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607795947781:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607795947797:scale_y_continuous(name="Logaritmo da magnitude")
1607795951361:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607795965051:g.orders
1607795974323:dt[(freq>0) & (width == widths[1])]
1607795983722:dt[(freq>0) & (width == widths[[1]])]
1607795987804:dt[, unique(width)]
1607795990826:widths
1607796004426:g.widths <- ggplot(dt[(freq>0) & (order == orders[2])], aes(freq, y, color=width)) +
1607796004446:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796004465:geom_line() +
1607796004481:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796004500:theme_pander() +
1607796004519:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796004536:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796004556:scale_y_continuous(name="Logaritmo da magnitude")
1607796004751:g.orders <- ggplot(dt[(freq>0) & (width == widths[2])], aes(freq, y, color=order)) +
1607796004769:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796004785:geom_line() +
1607796004804:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796004820:theme_pander() +
1607796004839:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796004855:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796004872:scale_y_continuous(name="Logaritmo da magnitude")
1607796005372:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607796142158:dt <- data.table()
1607796142385:for (derivative in 0:2)
1607796152560:a
1607796155290:for (derivative in 0:2) {
1607796155316:for (order in orders[orders > derivative]){
1607796155337:for (width in widths[widths > order*2]) {
1607796155359:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796155378:res <- filter(impulse.response, coefs)
1607796155397:res.log <- log10(abs(fft(res)))
1607796155414:freqs <- fftfreq(length(res), d=1)
1607796155438:dt <- rbind(dt,
1607796155457:data.table(y=res.log,
1607796155473:freq=freqs,
1607796155492:width = as.factor(width),
1607796155508:order = as.factor(order),
1607796155528:derivative = derivative))
1607796155550:}
1607796155576:}
1607796155602:}
1607796172457:g.widths <- ggplot(dt[(freq>0) & (order == orders[2]) & (derivative == 1)],
1607796172474:aes(freq, y, color=width)) +
1607796172492:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796172512:geom_line() +
1607796172538:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796172557:theme_pander() +
1607796172575:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796172596:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796172614:scale_y_continuous(name="Logaritmo da magnitude")
1607796173146:g.orders <- ggplot(dt[(freq>0) & (width == widths[2])], aes(freq, y, color=order)) +
1607796173164:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796173183:geom_line() +
1607796173200:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796173218:theme_pander() +
1607796173235:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796173252:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796173268:scale_y_continuous(name="Logaritmo da magnitude")
1607796175307:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607796202754:g.orders <- ggplot(dt[(freq>0) & (width == widths[2]) & (derivative == 1)], aes(freq, y, color=order)) +
1607796202774:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796202792:geom_line() +
1607796202810:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796202827:theme_pander() +
1607796202846:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796202865:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796202882:scale_y_continuous(name="Logaritmo da magnitude")
1607796203106:arrangeGrob(g.widths, g.orders, nrow=2) %>% grid.draw
1607796554670:plot.magnitudes <- function(dt, derivative) {
1607796554697:g.widths <- ggplot(dt[(freq>0) & (order == orders[2]) & (derivative == derivative)],
1607796554716:aes(freq, y, color=width)) +
1607796554736:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796554754:geom_line() +
1607796554772:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796554790:theme_pander() +
1607796554807:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796554826:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796554843:scale_y_continuous(name="Logaritmo da magnitude")
1607796554875:g.orders <- ggplot(dt[(freq>0) & (width == widths[2]) & (derivative == derivative)],
1607796554895:aes(freq, y, color=order)) +
1607796554912:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796554933:geom_line() +
1607796554951:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796554970:theme_pander() +
1607796554987:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796555006:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796555024:scale_y_continuous(name="Logaritmo da magnitude")
1607796555056:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796555074:}
1607796565291:plot.derivative(dt, derivative=0) %>% plot
1607796567570:plot.magnitudes <- function(dt, derivative) {
1607796567595:g.widths <- ggplot(dt[(freq>0) & (order == orders[2]) & (derivative == derivative)],
1607796567612:aes(freq, y, color=width)) +
1607796567630:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796567647:geom_line() +
1607796567664:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796567684:theme_pander() +
1607796567703:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796567722:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796567740:scale_y_continuous(name="Logaritmo da magnitude")
1607796567769:g.orders <- ggplot(dt[(freq>0) & (width == widths[2]) & (derivative == derivative)],
1607796567788:aes(freq, y, color=order)) +
1607796567804:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796567822:geom_line() +
1607796567840:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796567856:theme_pander() +
1607796567873:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796567889:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796567907:scale_y_continuous(name="Logaritmo da magnitude")
1607796567937:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796567954:}
1607796568432:plot.derivative(dt, derivative=0) %>% plot
1607796575955:plot.magnitudes(dt, derivative=0) %>% plot
1607796585080:plot.magnitudes(dt, derivative=0) %>% plot
1607796622586:plot.magnitudes <- function(dt, derivative) {
1607796622612:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == derivative)],
1607796622628:aes(freq, y, color=width)) +
1607796622644:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796622660:geom_line() +
1607796622676:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796622697:theme_pander() +
1607796622717:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796622734:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796622752:scale_y_continuous(name="Logaritmo da magnitude")
1607796622792:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == derivative)],
1607796622810:aes(freq, y, color=order)) +
1607796622827:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796622843:geom_line() +
1607796622860:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796622876:theme_pander() +
1607796622893:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796622909:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796622924:scale_y_continuous(name="Logaritmo da magnitude")
1607796622955:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796622975:}
1607796622992:plot.magnitudes(dt, derivative=0) %>% plot
1607796638472:for (derivative in 0:2) {
1607796638495:for (order in orders[orders > derivative]){
1607796638512:for (width in widths[widths > order*2]) {
1607796638529:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796638546:res <- filter(impulse.response, coefs)
1607796638564:res.log <- log10(abs(fft(res)))
1607796638583:freqs <- fftfreq(length(res), d=1)
1607796638609:dt <- rbind(dt,
1607796638629:data.table(y=res.log,
1607796638646:freq=freqs,
1607796638663:width = as.string(width),
1607796638680:order = as.string(order),
1607796638696:derivative = derivative))
1607796638711:}
1607796638735:}
1607796638760:}
1607796650075:for (derivative in 0:2) {
1607796650100:for (order in orders[orders > derivative]){
1607796650118:for (width in widths[widths > order*2]) {
1607796650136:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796650155:res <- filter(impulse.response, coefs)
1607796650175:res.log <- log10(abs(fft(res)))
1607796650195:freqs <- fftfreq(length(res), d=1)
1607796650220:dt <- rbind(dt,
1607796650240:data.table(y=res.log,
1607796650259:freq=freqs,
1607796650277:width = as.character(width),
1607796650295:order = as.character(order),
1607796650316:derivative = derivative))
1607796650335:}
1607796650358:}
1607796650383:}
1607796651224:plot.magnitudes <- function(dt, derivative) {
1607796651256:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == derivative)],
1607796651291:aes(freq, y, color=width)) +
1607796651313:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796651328:geom_line() +
1607796651344:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796651361:theme_pander() +
1607796651379:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796651394:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796651411:scale_y_continuous(name="Logaritmo da magnitude")
1607796651443:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == derivative)],
1607796651460:aes(freq, y, color=order)) +
1607796651479:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796651496:geom_line() +
1607796651512:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796651529:theme_pander() +
1607796651546:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796651564:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796651582:scale_y_continuous(name="Logaritmo da magnitude")
1607796651616:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796651636:}
1607796651653:plot.magnitudes(dt, derivative=0) %>% plot
1607796661007:dt[, min(width)]
1607796670589:dt <- data.table()
1607796670720:for (derivative in 0:2) {
1607796670745:for (order in orders[orders > derivative]){
1607796670764:for (width in widths[widths > order*2]) {
1607796670782:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796670800:res <- filter(impulse.response, coefs)
1607796670818:res.log <- log10(abs(fft(res)))
1607796670841:freqs <- fftfreq(length(res), d=1)
1607796670870:dt <- rbind(dt,
1607796670890:data.table(y=res.log,
1607796670910:freq=freqs,
1607796670925:width = as.character(width),
1607796670944:order = as.character(order),
1607796670963:derivative = derivative))
1607796670983:}
1607796671007:}
1607796671030:}
1607796671855:plot.magnitudes <- function(dt, derivative) {
1607796671887:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == derivative)],
1607796671913:aes(freq, y, color=width)) +
1607796671938:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796671953:geom_line() +
1607796671967:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796671982:theme_pander() +
1607796671998:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796672016:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796672032:scale_y_continuous(name="Logaritmo da magnitude")
1607796672068:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == derivative)],
1607796672089:aes(freq, y, color=order)) +
1607796672105:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796672124:geom_line() +
1607796672143:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796672160:theme_pander() +
1607796672178:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796672196:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796672216:scale_y_continuous(name="Logaritmo da magnitude")
1607796672247:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796672267:}
1607796672823:plot.magnitudes(dt, derivative=0) %>% plot
1607796685037:derivative = 0
1607796689337:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == derivative)],
1607796689356:aes(freq, y, color=width)) +
1607796689375:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796689393:geom_line() +
1607796689409:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796689425:theme_pander() +
1607796689442:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796689457:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796689474:scale_y_continuous(name="Logaritmo da magnitude")
1607796694576:g.widths
1607796708940:dt[(freq>0) & (order == min(order)) & (derivative == derivative)]
1607796724912:dt[(freq>0) & (order == min(order)) & (derivative == derivative)][, unique(order)]
1607796730936:dt[(freq>0) & (order == min(order)) & (derivative == derivative)][, unique(width)]
1607796749627:plot.magnitudes(dt, derivative=1) %>% plot
1607796776346:dt[(freq>0) & (order == min(order)) & (derivative == derivative)][, unique(derivative)]
1607796798338:plot.magnitudes <- function(dt, derivative) {
1607796798365:.derivative <- derivative
1607796798385:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607796798405:aes(freq, y, color=width)) +
1607796798425:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796798447:geom_line() +
1607796798464:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796798486:theme_pander() +
1607796798507:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796798530:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796798551:scale_y_continuous(name="Logaritmo da magnitude")
1607796798601:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == derivative)],
1607796798626:aes(freq, y, color=order)) +
1607796798648:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796798669:geom_line() +
1607796798691:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796798713:theme_pander() +
1607796798729:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796798745:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796798761:scale_y_continuous(name="Logaritmo da magnitude")
1607796798794:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796798812:}
1607796798831:plot.magnitudes(dt, derivative=1) %>% plot
1607796809546:plot.magnitudes <- function(dt, derivative) {
1607796809571:.derivative <- derivative
1607796809590:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607796809607:aes(freq, y, color=width)) +
1607796809626:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796809645:geom_line() +
1607796809665:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796809684:theme_pander() +
1607796809702:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796809718:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796809736:scale_y_continuous(name="Logaritmo da magnitude")
1607796809764:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607796809782:aes(freq, y, color=order)) +
1607796809802:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796809818:geom_line() +
1607796809834:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796809851:theme_pander() +
1607796809869:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796809888:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796809906:scale_y_continuous(name="Logaritmo da magnitude")
1607796809940:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796809960:}
1607796809981:plot.magnitudes(dt, derivative=1) %>% plot
1607796861410:for (derivative in 0:2) {
1607796861433:for (order in orders[orders > derivative]){
1607796861451:for (width in widths[widths > order*2]) {
1607796861468:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796861483:res <- filter(impulse.response, coefs)
1607796861500:res.log <- 10*log10(abs(fft(res)))
1607796861518:freqs <- fftfreq(length(res), d=1)
1607796861543:dt <- rbind(dt,
1607796861558:data.table(y=res.log,
1607796861577:freq=freqs,
1607796861596:width = as.character(width),
1607796861612:order = as.character(order),
1607796861630:derivative = derivative))
1607796861650:}
1607796861674:}
1607796861698:}
1607796862941:plot.magnitudes <- function(dt, derivative) {
1607796862974:.derivative <- derivative
1607796862994:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607796863013:aes(freq, y, color=width)) +
1607796863027:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796863042:geom_line() +
1607796863057:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796863072:theme_pander() +
1607796863089:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796863107:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796863124:scale_y_continuous(name="Logaritmo da magnitude")
1607796863158:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607796863176:aes(freq, y, color=order)) +
1607796863192:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796863211:geom_line() +
1607796863228:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796863246:theme_pander() +
1607796863265:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796863284:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796863299:scale_y_continuous(name="Logaritmo da magnitude")
1607796863330:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796863347:}
1607796863365:plot.magnitudes(dt, derivative=1) %>% plot
1607796872732:dt <- data.table()
1607796873057:for (derivative in 0:2) {
1607796873082:for (order in orders[orders > derivative]){
1607796873101:for (width in widths[widths > order*2]) {
1607796873121:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796873138:res <- filter(impulse.response, coefs)
1607796873155:res.log <- 10*log10(abs(fft(res)))
1607796873174:freqs <- fftfreq(length(res), d=1)
1607796873199:dt <- rbind(dt,
1607796873216:data.table(y=res.log,
1607796873236:freq=freqs,
1607796873255:width = as.character(width),
1607796873271:order = as.character(order),
1607796873287:derivative = derivative))
1607796873305:}
1607796873330:}
1607796873358:}
1607796874197:plot.magnitudes <- function(dt, derivative) {
1607796874235:.derivative <- derivative
1607796874262:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607796874284:aes(freq, y, color=width)) +
1607796874299:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796874314:geom_line() +
1607796874333:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796874351:theme_pander() +
1607796874371:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796874389:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796874405:scale_y_continuous(name="Logaritmo da magnitude")
1607796874437:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607796874454:aes(freq, y, color=order)) +
1607796874472:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796874488:geom_line() +
1607796874504:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796874522:theme_pander() +
1607796874537:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796874554:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796874571:scale_y_continuous(name="Logaritmo da magnitude")
1607796874603:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796874620:}
1607796874650:plot.magnitudes(dt, derivative=1) %>% plot
1607796925167:res.log
1607796928343:res.log %> max()
1607796940943:dt <- data.table()
1607796941162:for (derivative in 0:2) {
1607796941185:for (order in orders[orders > derivative]){
1607796941202:for (width in widths[widths > order*2]) {
1607796941219:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607796941237:res <- filter(impulse.response, coefs)
1607796941253:res.log <- log10(abs(fft(res)))
1607796941270:freqs <- fftfreq(length(res), d=1)
1607796941294:dt <- rbind(dt,
1607796941309:data.table(y=res.log,
1607796941329:freq=freqs,
1607796941347:width = as.character(width),
1607796941366:order = as.character(order),
1607796941383:derivative = derivative))
1607796941402:}
1607796941427:}
1607796941450:}
1607796948881:plot.magnitudes <- function(dt, derivative) {
1607796948907:.derivative <- derivative
1607796948924:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607796948941:aes(freq, y, color=width)) +
1607796948958:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796948974:geom_line() +
1607796948990:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796949007:theme_pander() +
1607796949025:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607796949053:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796949073:scale_y_continuous(name="Logaritmo da magnitude")
1607796949104:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607796949122:aes(freq, y, color=order)) +
1607796949139:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607796949155:geom_line() +
1607796949174:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607796949191:theme_pander() +
1607796949208:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607796949228:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607796949247:scale_y_continuous(name="Logaritmo da magnitude")
1607796949276:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607796949295:}
1607796949315:plot.magnitudes(dt, derivative=1) %>% plot
1607797084425:widths <- seq(1, 300, 90)
1607797084440:orders <- seq(3, 10, 2)
1607797084467:impulse.response <- generate.impulse.response(2000)
1607797084503:dt <- data.table()
1607797084521:for (derivative in 0:2) {
1607797084545:for (order in orders[orders > derivative]){
1607797084561:for (width in widths[widths > order*2]) {
1607797084578:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607797084593:res <- filter(impulse.response, coefs)
1607797084611:res.log <- log10(abs(fft(res)))
1607797084631:freqs <- fftfreq(length(res), d=1)
1607797084656:dt <- rbind(dt,
1607797084675:data.table(y=res.log,
1607797084693:freq=freqs,
1607797084710:width = as.character(width),
1607797084728:order = as.character(order),
1607797084744:derivative = derivative))
1607797084761:}
1607797084785:}
1607797084809:}
1607797085697:plot.magnitudes <- function(dt, derivative) {
1607797085735:.derivative <- derivative
1607797085760:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == derivative)],
1607797085776:aes(freq, y, color=width)) +
1607797085790:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797085806:geom_line() +
1607797085821:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797085838:theme_pander() +
1607797085859:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797085877:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797085893:scale_y_continuous(name="Logaritmo da magnitude")
1607797085923:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == derivative)],
1607797085939:aes(freq, y, color=order)) +
1607797085955:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797085972:geom_line() +
1607797085989:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797086007:theme_pander() +
1607797086023:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797086040:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797086056:scale_y_continuous(name="Logaritmo da magnitude")
1607797086084:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797086100:}
1607797086128:plot.magnitudes(dt, derivative=1) %>% plot
1607797100992:plot.magnitudes <- function(dt, derivative) {
1607797101017:.derivative <- derivative
1607797101034:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607797101051:aes(freq, y, color=width)) +
1607797101066:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797101083:geom_line() +
1607797101101:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797101118:theme_pander() +
1607797101137:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797101154:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797101171:scale_y_continuous(name="Logaritmo da magnitude")
1607797101201:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607797101218:aes(freq, y, color=order)) +
1607797101240:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797101259:geom_line() +
1607797101279:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797101296:theme_pander() +
1607797101316:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797101337:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797101360:scale_y_continuous(name="Logaritmo da magnitude")
1607797101390:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797101409:}
1607797101431:plot.magnitudes(dt, derivative=1) %>% plot
1607797114460:plot.magnitudes(dt, derivative=0) %>% plot
1607797214448:factorial(0)
1607797216135:factorial(2)
1607797534805:pi
1607797543365:dt[, y_ideal := (freq*pi)^derivative]
1607797565417:dt[, y_ideal := log10((freq*pi)^derivative)]
1607797574852:plot.magnitudes <- function(dt, derivative) {
1607797574878:.derivative <- derivative
1607797574897:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607797574915:aes(freq, y - y_ideal, color=width)) +
1607797574934:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797574951:geom_line() +
1607797574971:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797574989:theme_pander() +
1607797575007:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797575025:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797575044:scale_y_continuous(name="Logaritmo da magnitude")
1607797575074:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607797575091:aes(freq, y, color=order)) +
1607797575112:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797575131:geom_line() +
1607797575147:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797575166:theme_pander() +
1607797575187:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797575207:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797575226:scale_y_continuous(name="Logaritmo da magnitude")
1607797575257:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797575276:}
1607797575296:plot.magnitudes(dt, derivative=0) %>% plot
1607797595002:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == 1)],
1607797595023:aes(freq, y - y_ideal, color=width)) +
1607797595043:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797595060:geom_line() +
1607797595078:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797595096:theme_pander() +
1607797595116:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797595134:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797595152:scale_y_continuous(name="Logaritmo da magnitude")
1607797597765:g.widhts
1607797599484:g.widths
1607797603014:dt
1607797618326:dt[, y - y_ideal]
1607797626628:dt[, as.numeric(y - y_ideal)]
1607797630987:dt[, as.numeric(y) - y_ideal]
1607797646655:for (derivative in 0:2) {
1607797646681:for (order in orders[orders > derivative]){
1607797646698:for (width in widths[widths > order*2]) {
1607797646715:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607797646734:res <- filter(impulse.response, coefs)
1607797646752:res.log <- log10(abs(fft(res)))
1607797646771:freqs <- fftfreq(length(res), d=1)
1607797646797:dt <- rbind(dt,
1607797646815:data.table(y= as.numeric(res.log),
1607797646832:freq=freqs,
1607797646848:width = as.character(width),
1607797646867:order = as.character(order),
1607797646887:derivative = derivative))
1607797646906:}
1607797646930:}
1607797646955:}
1607797649902:dt <- data.table()
1607797650053:for (derivative in 0:2) {
1607797650080:for (order in orders[orders > derivative]){
1607797650098:for (width in widths[widths > order*2]) {
1607797650115:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607797650131:res <- filter(impulse.response, coefs)
1607797650147:res.log <- log10(abs(fft(res)))
1607797650166:freqs <- fftfreq(length(res), d=1)
1607797650191:dt <- rbind(dt,
1607797650209:data.table(y= as.numeric(res.log),
1607797650227:freq=freqs,
1607797650248:width = as.character(width),
1607797650266:order = as.character(order),
1607797650287:derivative = derivative))
1607797650307:}
1607797650333:}
1607797650359:}
1607797651183:dt[, y_ideal := log10((freq*pi)^derivative)]
1607797653798:plot.magnitudes <- function(dt, derivative) {
1607797653823:.derivative <- derivative
1607797653840:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607797653858:aes(freq, y - y_ideal, color=width)) +
1607797653873:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797653891:geom_line() +
1607797653906:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797653922:theme_pander() +
1607797653940:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797653957:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797653976:scale_y_continuous(name="Logaritmo da magnitude")
1607797654011:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607797654028:aes(freq, y, color=order)) +
1607797654047:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797654066:geom_line() +
1607797654085:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797654102:theme_pander() +
1607797654119:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797654136:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797654156:scale_y_continuous(name="Logaritmo da magnitude")
1607797654191:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797654211:}
1607797654232:plot.magnitudes(dt, derivative=0) %>% plot
1607797663071:plot.magnitudes(dt, derivative=1) %>% plot
1607797700661:plot.magnitudes(dt, derivative=2) %>% plot
1607797716238:plot.magnitudes <- function(dt, derivative) {
1607797716262:.derivative <- derivative
1607797716281:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607797716299:aes(freq, y - y_ideal, color=width)) +
1607797716317:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797716334:geom_line() +
1607797716351:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797716370:theme_pander() +
1607797716388:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797716404:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797716420:scale_y_continuous(name="Logaritmo da magnitude")
1607797716453:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607797716472:aes(freq, y - y_ideal, color=order)) +
1607797716488:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797716504:geom_line() +
1607797716519:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797716538:theme_pander() +
1607797716556:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797716573:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797716589:scale_y_continuous(name="Logaritmo da magnitude")
1607797716621:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797716638:}
1607797716659:plot.magnitudes(dt, derivative=2) %>% plot
1607797743685:plot.magnitudes <- function(dt, derivative) {
1607797743710:.derivative <- derivative
1607797743728:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607797743747:aes(freq, y, color=width)) +
1607797743763:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797743780:geom_line() +
1607797743798:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797743814:theme_pander() +
1607797743833:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607797743849:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797743870:scale_y_continuous(name="Logaritmo da magnitude")
1607797743902:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607797743920:aes(freq, y, color=order)) +
1607797743937:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607797743955:geom_line() +
1607797743973:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607797743991:theme_pander() +
1607797744007:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607797744021:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607797744038:scale_y_continuous(name="Logaritmo da magnitude")
1607797744069:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607797744086:}
1607797744105:plot.magnitudes(dt, derivative=2) %>% plot
1607797754003:dt[(order==3)]
1607797768933:dt[(order==3) & (width == 91) & derivative == 0]
1607797781873:ggplot(dt[(order==3) & (width == 91) & derivative == 0]) +
1607797781893:geom_line(aes(freq, y))
1607797786686:ggplot(dt[(order==3) & (width == 91) & derivative == 1]) +
1607797786703:geom_line(aes(freq, y))
1607797818885:ggplot(dt[(order==3) & (width == 91) & derivative == 2]) +
1607797818902:geom_line(aes(freq, y))
1607797835069:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607797835091:res <- filter(impulse.response, coefs)
1607797836227:res
1607797855691:filter <- function(x, filter) {
1607797855708:x <- as.numeric(stats::filter(x, filter, method="convolution"))
1607797855725:x[is.na(x)] <- 0
1607797855743:return(x)
1607797855759:}
1607797859309:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607797859332:res <- filter(impulse.response, coefs)
1607797860388:res
1607797873710:%>% length
1607797878346:res %>% length
1607797898635:coefs <- filter.coef(width=width, order=order, derivative=0)
1607797898653:res <- filter(impulse.response, coefs)
1607797901619:res %>% length
1607797906149:res
1607797911516:coefs
1607797916100:impulse.response
1607797920820:res <- filter(impulse.response, coefs)
1607797922124:res
1607797934634:plot(res)
1607797952101:plot(abs(fft(res)))
1607797959230:abs(fft(res))
1607798252053:res
1607798253771:plot(abs(fft(res)))
1607798259149:plot(fft(res))
1607798282626:plot(fft(fft(res)))
1607798291546:plot(fft(fft(fft(res))))
1607798403265:coefs <- filter.coef(15, 6, derivada=1)
1607798410533:coefs <- filter.coef(15, 6, derivative=1)
1607798411151:data = data.table(x=rep.like(coefs),
1607798411171:y=coefs)
1607798411892:ggplot(data) +
1607798411910:geom_hline(yintercept = 0, color=.gray, alpha=0.5) +
1607798411929:geom_line(aes(x=x, y=y), color=.blue) +
1607798411948:theme_bw()
1607798486606:ggplot(dt[(order==3) & (width == 91) & derivative == 1]) +
1607798486629:geom_line(aes(freq, y))
1607798499121:ggplot(dt[(order==3) & (width == 91) & derivative == 1]) +
1607798499139:geom_line(aes(freq, exp(y)))
1607798531443:widths <- seq(1, 300, 10)
1607798531596:orders <- seq(3, 10, 2)
1607798531746:impulse.response <- generate.impulse.response(2000)
1607798531905:dt <- data.table()
1607798532076:for (derivative in 0:2) {
1607798532104:for (order in orders[orders > derivative]){
1607798532122:for (width in widths[widths > order*2]) {
1607798532141:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607798532157:res <- filter(impulse.response, coefs)
1607798532175:res.log <- log10(abs(fft(res)))
1607798532195:freqs <- fftfreq(length(res), d=1)
1607798532220:dt <- rbind(dt,
1607798532241:data.table(y= as.numeric(res.log),
1607798532258:freq=freqs,
1607798532277:width = as.character(width),
1607798532293:order = as.character(order),
1607798532309:derivative = derivative))
1607798532329:}
1607798532354:}
1607798532379:}
1607799616232:ggplot(dt[(order==3) & (width == min(width)) & derivative == 1]) +
1607799616250:geom_line(aes(freq, exp(y)))
1607799623615:ggplot(dt[(order==3) & (width == max(width)) & derivative == 1]) +
1607799623633:geom_line(aes(freq, exp(y)))
1607799640424:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607799640627:ggplot(sel.dt) +
1607799640649:geom_line(aes(freq, exp(y)))
1607799648233:sel.dt
1607799672166:width = 91
1607799673446:order = 3
1607799679887:derivative = 1
1607799684282:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607799688173:res <- filter(impulse.response, coefs)
1607799689614:res
1607799701742:res[res != 0]
1607799711166:res.log <- log10(abs(fft(res)))
1607799714607:res.log
1607799729925:fft(res)
1607799741486:fft(res)[!is.finite(fft(res))]
1607799755476:res.log[!is.finite(res.log)]
1607799772775:res[!is.finite(res.log)]
1607799825134:dt <- data.table()
1607799825262:for (derivative in 0:2) {
1607799825288:for (order in orders[orders > derivative]){
1607799825306:for (width in widths[widths > order*2]) {
1607799825324:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607799825341:res <- filter(impulse.response, coefs)
1607799825358:res.log <- log10(abs(fft(res)))
1607799825374:freqs <- fftfreq(length(res), d=1)
1607799825399:dt <- rbind(dt,
1607799825417:data.table(y= as.numeric(res.log),
1607799825435:fft=fft(res),
1607799825453:freq=freqs,
1607799825467:width = as.character(width),
1607799825485:order = as.character(order),
1607799825503:derivative = derivative))
1607799825520:}
1607799825545:}
1607799825572:}
1607799833471:widths <- seq(1, 300, 90)
1607799833622:orders <- seq(3, 10, 2)
1607799833757:impulse.response <- generate.impulse.response(2000)
1607799833950:dt <- data.table()
1607799834550:for (derivative in 0:2) {
1607799834574:for (order in orders[orders > derivative]){
1607799834594:for (width in widths[widths > order*2]) {
1607799834617:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607799834634:res <- filter(impulse.response, coefs)
1607799834651:res.log <- log10(abs(fft(res)))
1607799834669:freqs <- fftfreq(length(res), d=1)
1607799834697:dt <- rbind(dt,
1607799834715:data.table(y= as.numeric(res.log),
1607799834732:fft=fft(res),
1607799834749:freq=freqs,
1607799834766:width = as.character(width),
1607799834784:order = as.character(order),
1607799834802:derivative = derivative))
1607799834817:}
1607799834840:}
1607799834866:}
1607799869221:plot.magnitudes <- function(dt, derivative) {
1607799869250:.derivative <- derivative
1607799869268:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607799869288:aes(freq, log10(y/y_ideal), color=width)) +
1607799869305:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799869324:geom_line() +
1607799869343:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799869361:theme_pander() +
1607799869379:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607799869397:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799869416:scale_y_continuous(name="Logaritmo da magnitude")
1607799869447:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607799869463:aes(freq, y, color=order)) +
1607799869481:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799869501:geom_line() +
1607799869519:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799869537:theme_pander() +
1607799869554:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607799869573:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799869590:scale_y_continuous(name="Logaritmo da magnitude")
1607799869620:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607799869638:}
1607799869658:plot.magnitudes(dt, derivative=2) %>% plot
1607799876373:dt[, y_ideal := log10((freq*pi)^derivative)]
1607799879182:plot.magnitudes <- function(dt, derivative) {
1607799879208:.derivative <- derivative
1607799879224:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607799879240:aes(freq, log10(y/y_ideal), color=width)) +
1607799879256:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799879274:geom_line() +
1607799879291:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799879308:theme_pander() +
1607799879325:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607799879342:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799879362:scale_y_continuous(name="Logaritmo da magnitude")
1607799879394:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607799879410:aes(freq, y, color=order)) +
1607799879425:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799879441:geom_line() +
1607799879457:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799879476:theme_pander() +
1607799879494:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607799879509:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799879527:scale_y_continuous(name="Logaritmo da magnitude")
1607799879560:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607799879577:}
1607799879597:plot.magnitudes(dt, derivative=2) %>% plot
1607799978455:plot.magnitudes <- function(dt, derivative) {
1607799978484:.derivative <- derivative
1607799978501:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607799978517:aes(freq, log10(abs(y)/abs(y_ideal)), color=width)) +
1607799978534:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799978549:geom_line() +
1607799978567:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799978584:theme_pander() +
1607799978601:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607799978618:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799978636:scale_y_continuous(name="Logaritmo da magnitude")
1607799978667:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607799978684:aes(freq, y, color=order)) +
1607799978699:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607799978715:geom_line() +
1607799978732:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607799978752:theme_pander() +
1607799978768:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607799978784:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607799978800:scale_y_continuous(name="Logaritmo da magnitude")
1607799978831:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607799978848:}
1607799978878:plot.magnitudes(dt, derivative=2) %>% plot
1607799994427:plot.magnitudes(dt, derivative=1) %>% plot
1607800043535:plot.magnitudes <- function(dt, derivative) {
1607800043567:.derivative <- derivative
1607800043584:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607800043601:aes(freq, log10(abs(fft)/abs(y_ideal)), color=width)) +
1607800043618:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607800043637:geom_line() +
1607800043656:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607800043674:theme_pander() +
1607800043689:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607800043708:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607800043725:scale_y_continuous(name="Logaritmo da magnitude")
1607800043756:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607800043772:aes(freq, y, color=order)) +
1607800043792:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607800043815:geom_line() +
1607800043832:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607800043849:theme_pander() +
1607800043866:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607800043887:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607800043907:scale_y_continuous(name="Logaritmo da magnitude")
1607800043942:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607800043961:}
1607800045680:plot.magnitudes(dt, derivative=1) %>% plot
1607800115882:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607800116079:ggplot(sel.dt) +
1607800116100:geom_line(aes(freq, exp(y)))
1607800130661:ggplot(sel.dt) +
1607800130679:geom_line(aes(freq, log10(fft)))
1607800146181:dt <- data.table()
1607800146348:for (derivative in 0:2) {
1607800146374:for (order in orders[orders > derivative]){
1607800146390:for (width in widths[widths > order*2]) {
1607800146408:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800146424:res <- filter(impulse.response, coefs)
1607800146441:res.log <- log10(abs(fft(res)))
1607800146459:freqs <- fftfreq(length(res), d=1)
1607800146486:dt <- rbind(dt,
1607800146505:data.table(y= as.numeric(res.log),
1607800146527:f=fft(res),
1607800146548:freq=freqs,
1607800146564:width = as.character(width),
1607800146580:order = as.character(order),
1607800146595:derivative = derivative))
1607800146617:}
1607800146639:}
1607800146662:}
1607800159174:dt[, y_ideal := (freq*pi)^derivative)]
1607800162109:dt[, y_ideal := (freq*pi)^derivative]
1607800169680:dt[, y_ideal := (freq*pi)^derivative]
1607800170637:plot.magnitudes <- function(dt, derivative) {
1607800170664:.derivative <- derivative
1607800170683:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607800170700:aes(freq, log10(abs(f)/abs(y_ideal)), color=width)) +
1607800170719:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607800170735:geom_line() +
1607800170752:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607800170768:theme_pander() +
1607800170787:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607800170808:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607800170827:scale_y_continuous(name="Logaritmo da magnitude")
1607800170860:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607800170878:aes(freq, y, color=order)) +
1607800170897:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607800170914:geom_line() +
1607800170932:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607800170951:theme_pander() +
1607800170967:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607800170985:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607800171002:scale_y_continuous(name="Logaritmo da magnitude")
1607800171035:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607800171053:}
1607800171071:plot.magnitudes(dt, derivative=1) %>% plot
1607800195053:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607800195236:ggplot(sel.dt) +
1607800195253:geom_line(aes(freq, log10(fft)))
1607800208790:ggplot(sel.dt) +
1607800208807:geom_line(aes(freq, abs(fft)))
1607800218772:ggplot(sel.dt) +
1607800218789:geom_line(aes(freq, abs(f)))
1607800246267:ggplot(sel.dt) +
1607800246286:geom_line(aes(freq, abs(fftshift(f))))
1607800268876:dt <- data.table()
1607800269220:for (derivative in 0:2) {
1607800269247:for (order in orders[orders > derivative]){
1607800269264:for (width in widths[widths > order*2]) {
1607800269283:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800269300:res <- filter(impulse.response, coefs)
1607800269320:res.log <- log10(abs(fft(res)))
1607800269338:freqs <- fftfreq(length(res), d=1)
1607800269364:dt <- rbind(dt,
1607800269382:data.table(y= as.numeric(res.log),
1607800269400:y_raw = as.numeric(res)
1607800269421:f=fft(res),
1607800269442:freq=freqs,
1607800269463:width = as.character(width),
1607800269480:order = as.character(order),
1607800269497:derivative = derivative))
1607800269516:}
1607800269542:}
1607800269566:}
1607800275488:dt <- data.table()
1607800275660:for (derivative in 0:2) {
1607800275699:for (order in orders[orders > derivative]){
1607800275719:for (width in widths[widths > order*2]) {
1607800275734:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800275751:res <- filter(impulse.response, coefs)
1607800275769:res.log <- log10(abs(fft(res)))
1607800275786:freqs <- fftfreq(length(res), d=1)
1607800275808:dt <- rbind(dt,
1607800275823:data.table(y= as.numeric(res.log),
1607800275841:y_raw = as.numeric(res),
1607800275859:f=fft(res),
1607800275875:freq=freqs,
1607800275890:width = as.character(width),
1607800275906:order = as.character(order),
1607800275924:derivative = derivative))
1607800275943:}
1607800275967:}
1607800275990:}
1607800277466:dt[, y_ideal := (freq*pi)^derivative]
1607800285439:dt
1607800323140:dt <- data.table()
1607800323712:for (derivative in 0:2) {
1607800323738:for (order in orders[orders > derivative]){
1607800323757:for (width in widths[widths > order*2]) {
1607800323774:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800323796:res <- filter(impulse.response, coefs)
1607800323816:res.log <- log10(abs(fft(res)))
1607800323830:freqs <- fftfreq(length(res), d=1)
1607800323854:dt <- rbind(dt,
1607800323872:data.table(y= as.numeric(res.log),
1607800323894:f=fft(res),
1607800323916:freq=freqs,
1607800323936:width = as.character(width),
1607800323957:order = as.character(order),
1607800323977:derivative = derivative))
1607800323996:}
1607800324021:}
1607800324048:}
1607800327884:res.log
1607800350660:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607800350957:ggplot(sel.dt) +
1607800350974:geom_line(aes(freq, res.log))
1607800368051:ggplot(sel.dt[is.finite(res.log)]) +
1607800368068:geom_line(aes(freq, res.log))
1607800389300:res.log
1607800395931:res.log[!is.finite(res.log)]
1607800401275:res[!is.finite(res)]
1607800463812:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800464069:res <- filter(impulse.response, coefs)
1607800466875:fft(res)
1607800470956:abs(fft(res))
1607800474810:a <- abs(fft(res))
1607800478715:a[min(a) == a]
1607800496419:plot(abs(fft(res)))
1607800509964:res[min(res) == res]
1607800517547:res[!is.finite(res)]
1607800520355:res
1607800528162:res[res != 0]
1607800540459:plot(res[res != 0])
1607800559578:plot(abs(fft(res)))
1607800583065:derivative = 0
1607800586394:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607800586676:res <- filter(impulse.response, coefs)
1607800589275:plot(abs(fft(res)))
1607800612779:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607800626989:ggplot(sel.dt) +
1607800627007:geom_line(aes(freq, abs(f)))
1607800628803:sel.dt <- dt[(order==3) & (width == max(width)) & derivative == 1]
1607800629276:ggplot(sel.dt) +
1607800629297:geom_line(aes(freq, abs(f)))
1607800646787:?geom_segment
1607800666581:ggplot(sel.dt) +
1607800666601:geom_line(aes(freq, abs(f))) +
1607800666618:geom_segment(aes(x=0, y=0, xend=0.2, yend=0.2))
1607800676204:ggplot(sel.dt) +
1607800676222:geom_line(aes(freq, abs(f))) +
1607800676240:geom_segment(aes(x=0, y=0, xend=0.2*pi, yend=0.2*pi))
1607800684181:ggplot(sel.dt) +
1607800684198:geom_line(aes(freq, abs(f))) +
1607800684216:geom_segment(aes(x=0, y=0, xend=0.2, yend=0.2*pi))
1607800694211:ggplot(sel.dt) +
1607800694228:geom_line(aes(freq, abs(f))) +
1607800694245:geom_segment(aes(x=0, y=0, xend=0.02, yend=0.02*pi))
1607800755219:ggplot(sel.dt) +
1607800755238:geom_line(aes(freq, log10(abs(f)))) +
1607800755255:geom_segment(aes(x=0, y=0, xend=0.02, yend=0.02*pi))
1607800763108:ggplot(sel.dt) +
1607800763127:geom_line(aes(freq, log10(abs(f)))) +
1607800763142:geom_segment(aes(x=0, y=0, xend=0.02, yend=log10(0.02*pi)))
1607800776860:ggplot(sel.dt) +
1607800776877:geom_line(aes(freq, log10(abs(f)))) +
1607800776892:geom_segment(aes(x=0, y=log10(0), xend=0.02, yend=log10(0.02*pi)))
1607800807293:ggplot(sel.dt) +
1607800807310:geom_line(aes(freq, abs(f))) +
1607800807330:geom_segment(aes(x=0, y=log10(0), xend=0.02, yend=0.02*pi))
1607800822869:ggplot(sel.dt) +
1607800822892:geom_line(aes(freq, abs(f))) +
1607800822911:geom_segment(aes(x=0, y=log10(0), xend=0.02, yend=0.02*pi)) +
1607800822928:xlim(-0.1, 0.1)
1607800847115:freq
1607800851985:sel.dt[, freq]
1607800924522:ggplot(sel.dt) +
1607800924542:geom_line(aes(freq, abs(f))) +
1607800924561:geom_line(aes(x=freq, y=freq*pi)) +
1607800924580:xlim(-0.1, 0.1)
1607800975505:sel.dt
1607800996450:sel.dt[, .(freq, abs(f))]
1607801004186:sel.dt[, .(freq, abs(f), abs(f)/freq)]
1607801020115:sel.dt[, .(freq, abs(f), abs(f)/freq)][, mean(V3)]
1607801024168:sel.dt[, .(freq, abs(f), abs(f)/freq)][, mean(V3, na.rm=T)]
1607801088769:sel.dt[, .(freq, abs(f), abs(f)/freq)][, mean(V3, na.rm=T)]
1607801092457:sel.dt[, .(freq, abs(f), abs(f)/freq)]
1607801103168:ggplot(sel.dt) +
1607801103185:geom_line(aes(freq, abs(f))) +
1607801103202:#geom_line(aes(x=freq, y=freq*pi*2)) +
1607801103219:xlim(-0.1, 0.1)
1607801121307:ggplot(sel.dt) +
1607801121325:geom_line(aes(freq, abs(f))) +
1607801121342:geom_line(aes(x=freq, y=freq*pi*2))
1607801130152:ggplot(sel.dt) +
1607801130171:geom_line(aes(freq, abs(f))) +
1607801130189:geom_line(aes(x=freq, y=freq*pi*2), color = .gray)
1607801140928:ggplot(sel.dt) +
1607801140947:geom_line(aes(freq, abs(f))) +
1607801140964:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray)
1607801156517:ggplot(sel.dt) +
1607801156539:geom_line(aes(freq, abs(f))) +
1607801156555:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607801156571:xlim(-0.1, 0.1)
1607801167330:ggplot(sel.dt) +
1607801167350:geom_line(aes(freq, abs(f))) +
1607801167367:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607801167384:xlim(-0.01, 0.01)
1607801189802:ggplot(sel.dt) +
1607801189820:geom_line(aes(freq, abs(f))) +
1607801189837:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607801189855:xlim(-0.01, 0.01) +
1607801189873:ylim(0, 0.1)
1607801210217:dt[, y_ideal := (freq*pi*2)^derivative]
1607801210530:plot.magnitudes <- function(dt, derivative) {
1607801210556:.derivative <- derivative
1607801210575:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607801210596:aes(freq, log10(abs(f)/abs(y_ideal)), color=width)) +
1607801210615:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801210632:geom_line() +
1607801210650:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801210671:theme_pander() +
1607801210689:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607801210705:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801210723:scale_y_continuous(name="Logaritmo da magnitude")
1607801210754:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607801210773:aes(freq, y, color=order)) +
1607801210792:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801210812:geom_line() +
1607801210831:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801210851:theme_pander() +
1607801210869:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607801210888:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801210906:scale_y_continuous(name="Logaritmo da magnitude")
1607801210938:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607801210954:}
1607801211077:plot.magnitudes(dt, derivative=1) %>% plot
1607801220885:plot.magnitudes(dt, derivative=2) %>% plot
1607801248854:plot.magnitudes(dt, derivative=2) %>% plot
1607801249444:}
1607801266754:plot.magnitudes <- function(dt, derivative) {
1607801266780:.derivative <- derivative
1607801266797:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607801266814:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=width)) +
1607801266829:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801266849:geom_line() +
1607801266864:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801266883:theme_pander() +
1607801266900:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607801266917:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801266933:scale_y_continuous(name="Logaritmo da magnitude")
1607801266963:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607801266981:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=order)) +
1607801266999:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801267017:geom_line() +
1607801267034:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801267052:theme_pander() +
1607801267069:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607801267087:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801267104:scale_y_continuous(name="Logaritmo da magnitude")
1607801267135:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607801267152:}
1607801267256:plot.magnitudes(dt, derivative=2) %>% plot
1607801336400:seq(11, 300, 90)
1607801344574:widths <- seq(11, 300, 90)
1607801344999:orders <- seq(3, 10, 2)
1607801345295:impulse.response <- generate.impulse.response(2000)
1607801345505:dt <- data.table()
1607801345720:for (derivative in 0:2) {
1607801345747:for (order in orders[orders > derivative]){
1607801345767:for (width in widths[widths > order*2]) {
1607801345783:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607801345802:res <- filter(impulse.response, coefs)
1607801345818:res.log <- log10(abs(fft(res)))
1607801345835:freqs <- fftfreq(length(res), d=1)
1607801345860:dt <- rbind(dt,
1607801345878:data.table(y= as.numeric(res.log),
1607801345899:f=fft(res),
1607801345915:freq=freqs,
1607801345934:width = as.character(width),
1607801345951:order = as.character(order),
1607801345970:derivative = derivative))
1607801345989:}
1607801346013:}
1607801346041:}
1607801347586:dt[, y_ideal := (freq*pi*2)^derivative]
1607801347610:plot.magnitudes <- function(dt, derivative) {
1607801347638:.derivative <- derivative
1607801347653:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607801347668:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=width)) +
1607801347681:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801347699:geom_line() +
1607801347724:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801347745:theme_pander() +
1607801347768:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607801347788:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801347807:scale_y_continuous(name="Logaritmo da magnitude")
1607801347841:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607801347859:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=order)) +
1607801347876:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801347894:geom_line() +
1607801347913:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801347929:theme_pander() +
1607801347947:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607801347965:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801347981:scale_y_continuous(name="Logaritmo da magnitude")
1607801348013:return(arrangeGrob(g.widths, g.orders, nrow=2) )
1607801348030:}
1607801348064:plot.magnitudes(dt, derivative=2) %>% plot
1607801406089:?arrangeGrob
1607801487437:plot.magnitudes(dt, derivative=1, title="1a derivada") %>% plot
1607801489329:plot.magnitudes <- function(dt, derivative, title="") {
1607801489355:.derivative <- derivative
1607801489371:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607801489389:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=width)) +
1607801489406:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801489424:geom_line() +
1607801489443:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801489460:theme_pander() +
1607801489476:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607801489494:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801489512:scale_y_continuous(name="Logaritmo da magnitude")
1607801489540:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607801489559:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=order)) +
1607801489577:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801489595:geom_line() +
1607801489614:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801489633:theme_pander() +
1607801489650:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607801489668:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801489687:scale_y_continuous(name="Logaritmo da magnitude")
1607801489722:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607801489739:main=textGrob(title,gp=gpar(fontsize=20,font=3))
1607801489757:)
1607801489775:)
1607801489791:}
1607801489956:plot.magnitudes(dt, derivative=1, title="1a derivada") %>% plot
1607801490411:plot.magnitudes(dt, derivative=2) %>% plot
1607801506721:plot.magnitudes <- function(dt, derivative, title="") {
1607801506747:.derivative <- derivative
1607801506762:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607801506777:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=width)) +
1607801506794:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801506812:geom_line() +
1607801506832:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801506848:theme_pander() +
1607801506862:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607801506878:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801506897:scale_y_continuous(name="Logaritmo da magnitude")
1607801506930:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607801506946:aes(freq, 10*log10(abs(f)/abs(y_ideal)), color=order)) +
1607801506961:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607801506980:geom_line() +
1607801506997:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607801507014:theme_pander() +
1607801507029:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607801507044:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607801507060:scale_y_continuous(name="Logaritmo da magnitude")
1607801507089:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607801507105:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607801507122:)
1607801507140:)
1607801507155:}
1607801507175:plot.magnitudes(dt, derivative=1, title="1a derivada") %>% plot
1607801507888:plot.magnitudes(dt, derivative=2) %>% plot
1607801555593:plot.magnitudes(dt, derivative=1, title="SG") %>% plot
1607801556058:plot.magnitudes(dt, derivative=1, title="SG 1a ordem") %>% plot
1607801560196:plot.magnitudes(dt, derivative=2, title="SG 2a ordem") %>% plot
1607801603552:?grid.draw
1607802028874:dt
1607802092990:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal)]
1607802112519:plot.magnitudes <- function(dt, derivative, title="") {
1607802112545:.derivative <- derivative
1607802112564:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607802112580:aes(freq, mag_ratio, color=width)) +
1607802112597:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802112617:geom_line() +
1607802112634:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802112651:theme_pander() +
1607802112669:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607802112686:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802112705:scale_y_continuous(name="Logaritmo da magnitude")
1607802112735:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607802112754:aes(freq, mag_ratio), color=order)) +
1607802112772:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802112791:geom_line() +
1607802112806:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802112824:theme_pander() +
1607802112844:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607802112861:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802112876:scale_y_continuous(name="Logaritmo da magnitude")
1607802112910:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607802112927:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607802112944:)
1607802112962:)
1607802112983:}
1607802113000:plot.magnitudes(dt, derivative=0, title="SG") %>% grid.draw
1607802127487:plot.magnitudes <- function(dt, derivative, title="") {
1607802127511:.derivative <- derivative
1607802127532:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607802127552:aes(freq, mag_ratio, color=width)) +
1607802127570:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802127588:geom_line() +
1607802127604:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802127623:theme_pander() +
1607802127642:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607802127662:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802127682:scale_y_continuous(name="Logaritmo da magnitude")
1607802127714:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607802127733:aes(freq, mag_ratio, color=order)) +
1607802127751:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802127770:geom_line() +
1607802127788:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802127807:theme_pander() +
1607802127825:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607802127843:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802127861:scale_y_continuous(name="Logaritmo da magnitude")
1607802127893:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607802127911:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607802127928:)
1607802127947:)
1607802127965:}
1607802128319:plot.magnitudes(dt, derivative=0, title="SG") %>% grid.draw
1607802131909:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607802133215:plot.magnitudes <- function(dt, derivative, title="") {
1607802133240:.derivative <- derivative
1607802133262:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607802133280:aes(freq, mag_ratio, color=width)) +
1607802133300:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802133319:geom_line() +
1607802133338:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802133354:theme_pander() +
1607802133374:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607802133392:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802133409:scale_y_continuous(name="Logaritmo da magnitude")
1607802133440:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607802133455:aes(freq, mag_ratio, color=order)) +
1607802133473:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607802133491:geom_line() +
1607802133509:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607802133526:theme_pander() +
1607802133543:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607802133562:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607802133578:scale_y_continuous(name="Logaritmo da magnitude")
1607802133609:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607802133628:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607802133646:)
1607802133664:)
1607802133680:}
1607802133700:plot.magnitudes(dt, derivative=0, title="SG") %>% grid.draw
1607802242815:dt.cutoff <- copy(dt)
1607802243200:dt.cutoff <- dt.cutoff[order(freq)]
1607802243535:dt.cutoff[, mag_ratio]
1607802311300:dt.cutoff <- copy(dt)
1607802311480:dt.cutoff <- dt.cutoff[mag_ratio <= -3]
1607802311661:dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607802322813:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607802339645:dt.cutoff
1607802367204:dt.cutoff
1607802476029:ggplot(dt.cutoff[ (derivative = 0)]) + geom_line(aes(x=order, y=freq, color=width))
1607802481240:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=order, y=freq, color=width))
1607802485851:dt.cutoff[ (derivative == 0)]
1607802542383:dt.cutoff <- copy(dt)
1607802542590:dt.cutoff <- dt.cutoff[ (freq >= 0) & (mag_ratio <= -3)]
1607802543032:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607802543748:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=order, y=freq, color=width))
1607802548445:dt.cutoff[ (derivative == 0)]
1607802563420:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=order, y=freq))
1607802576731:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq))
1607802585892:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width))
1607802598969:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=as.numeric(width)))
1607802607849:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width))
1607802673829:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607802673846:theme_pander()
1607802685908:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607802685927:theme_pander() +
1607802685945:scale_color_continuous_tableau()
1607802741869:levels <- dt.cutoff[order(width), unique(width)]
1607802742085:dt.cutoff[, width := factor(as.factor(width), levels=levels)]
1607802742891:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607802742910:theme_pander() +
1607802742927:scale_color_continuous_tableau()
1607802751731:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607802751749:theme_pander() +
1607802751769:scale_color_continuous_tableau()
1607802754763:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607802754781:theme_pander()
1607802864755:canva_pal(names(canva_palettes)[3])
1607802868318:canva_pal(names(canva_palettes)[3])(10)
1607802876177:names(canva_palettes)[3]
1607802888388:names(canva_palettes)[2]
1607802913589:colors <- canva_pal("Subdued and proffesional")
1607802928477:colors <- canva_pal("Subdued and proffesional")
1607802928651:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607802928668:theme_pander() +
1607802928685:scale_color_manual(values=colors)
1607802942676:scales::seq_gradient_pal(colors)
1607802950380:scales
1607802953562:library(scalee)
1607802954851:library(scales)
1607802959300:scales::seq_gradient_pal(colors)
1607802967298:colors
1607802970084:colors <- canva_pal("Subdued and proffesional")
1607802972659:colors <- canva_pal("Subdued and proffesional")(4)
1607802974788:colors
1607802977420:scales::seq_gradient_pal(colors)
1607802986392:scales::seq_gradient_pal(colors)(1:10)
1607802991074:colors
1607803027570:do.call(scales::seq_gradient_pal, colors)(1:10)
1607803039211:do.call(scales::seq_gradient_pal, as.list(colors))(1:10)
1607803067288:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803067306:theme_pander() +
1607803067323:scale_color_gradient()
1607803074356:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803074373:theme_pander() +
1607803074391:scale_color_gradientd()
1607803130572:ggplot(dt.cutoff[ (derivative == 0)]) + geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803130590:theme_pander()
1607803180434:widths <- seq(11, 300, 20)
1607803180456:orders <- seq(3, 10, 2)
1607803180481:impulse.response <- generate.impulse.response(2000)
1607803180517:dt <- data.table()
1607803180533:for (derivative in 0:2) {
1607803180561:for (order in orders[orders > derivative]){
1607803180577:for (width in widths[widths > order*2]) {
1607803180593:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607803180619:res <- filter(impulse.response, coefs)
1607803180635:res.log <- log10(abs(fft(res)))
1607803180650:freqs <- fftfreq(length(res), d=1)
1607803180672:dt <- rbind(dt,
1607803180687:data.table(y= as.numeric(res.log),
1607803180702:f=fft(res),
1607803180718:freq=freqs,
1607803180736:width = as.character(width),
1607803180756:order = as.character(order),
1607803180776:derivative = derivative))
1607803180792:}
1607803180816:}
1607803180846:}
1607803190100:dt[, y_ideal := (freq*pi*2)^derivative]
1607803190128:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607803190171:plot.magnitudes <- function(dt, derivative, title="") {
1607803190195:.derivative <- derivative
1607803190213:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607803190232:aes(freq, mag_ratio, color=width)) +
1607803190250:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803190270:geom_line() +
1607803190288:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803190308:theme_pander() +
1607803190326:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607803190343:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803190363:scale_y_continuous(name="Logaritmo da magnitude")
1607803190396:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607803190417:aes(freq, mag_ratio, color=order)) +
1607803190437:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803190453:geom_line() +
1607803190473:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803190491:theme_pander() +
1607803190509:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607803190528:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803190546:scale_y_continuous(name="Logaritmo da magnitude")
1607803190575:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607803190593:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607803190612:)
1607803190629:)
1607803190648:}
1607803193824:plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG") %>% grid.draw
1607803266996:widths <- seq(11, 300, 20)
1607803267154:orders <- seq(3, 10, 2)
1607803267299:impulse.response <- generate.impulse.response(2000)
1607803267451:dt <- data.table()
1607803267617:for (derivative in 0:2) {
1607803267644:for (order in orders[orders > derivative]){
1607803267661:for (width in widths[widths > order*2]) {
1607803267680:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607803267697:res <- filter(impulse.response, coefs)
1607803267713:res.log <- log10(abs(fft(res)))
1607803267732:freqs <- fftfreq(length(res), d=1)
1607803267756:dt <- rbind(dt,
1607803267775:data.table(y= as.numeric(res.log),
1607803267793:f=fft(res),
1607803267812:freq=freqs,
1607803267832:width = width,
1607803267848:order = order,
1607803267862:derivative = derivative))
1607803267880:}
1607803267903:}
1607803267925:}
1607803287314:dt[, width := factor(as.factor(width), levels=widths)]
1607803289993:plot.magnitudes <- function(dt, derivative, title="") {
1607803290018:.derivative <- derivative
1607803290042:g.widths <- ggplot(dt[(freq>0) & (order == min(order)) & (derivative == .derivative)],
1607803290066:aes(freq, mag_ratio, color=width)) +
1607803290087:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803290103:geom_line() +
1607803290122:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803290143:theme_pander() +
1607803290159:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607803290178:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803290197:scale_y_continuous(name="Logaritmo da magnitude")
1607803290225:g.orders <- ggplot(dt[(freq>0) & (width == min(width)) & (derivative == .derivative)],
1607803290246:aes(freq, mag_ratio, color=order)) +
1607803290264:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803290280:geom_line() +
1607803290297:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803290314:theme_pander() +
1607803290332:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607803290351:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803290368:scale_y_continuous(name="Logaritmo da magnitude")
1607803290400:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607803290421:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607803290441:)
1607803290457:)
1607803290477:}
1607803293336:plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG") %>% grid.draw
1607803328962:plot.magnitudes <- function(dt, derivative, title="") {
1607803328988:.derivative <- derivative
1607803329007:g.widths <- ggplot(dt[(freq>0) & (order == first(order)) & (derivative == .derivative)],
1607803329025:aes(freq, mag_ratio, color=width)) +
1607803329043:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803329059:geom_line() +
1607803329077:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803329095:theme_pander() +
1607803329114:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607803329131:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803329149:scale_y_continuous(name="Logaritmo da magnitude")
1607803329180:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607803329197:aes(freq, mag_ratio, color=order)) +
1607803329213:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803329229:geom_line() +
1607803329245:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803329262:theme_pander() +
1607803329277:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607803329293:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803329310:scale_y_continuous(name="Logaritmo da magnitude")
1607803329337:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607803329356:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607803329373:)
1607803329390:)
1607803329408:}
1607803330713:plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG") %>% grid.draw
1607803335841:dt[, y_ideal := (freq*pi*2)^derivative]
1607803335988:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607803338561:plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG") %>% grid.draw
1607803364902:plot.magnitudes <- function(dt, derivative, title="") {
1607803364924:.derivative <- derivative
1607803364944:g.widths <- ggplot(dt[(freq>0) & (order == first(order)) & (derivative == .derivative)],
1607803364965:aes(freq, mag_ratio, color=width)) +
1607803364986:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803365007:geom_line() +
1607803365023:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803365041:theme_pander() +
1607803365060:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607803365080:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803365096:scale_y_continuous(name="Logaritmo da magnitude")
1607803365127:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607803365145:aes(freq, mag_ratio, color=order)) +
1607803365162:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607803365182:geom_line() +
1607803365200:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607803365218:theme_pander() +
1607803365237:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607803365255:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607803365273:scale_y_continuous(name="Logaritmo da magnitude")
1607803365305:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607803365320:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607803365340:)
1607803365360:)
1607803365378:}
1607803365399:dt[, order := factor(as.factor(order), levels=orders)]
1607803365919:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607803365936:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607803365956:)
1607803365977:)
1607803366020:}
1607803366970:plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG") %>% grid.draw
1607803397614:dt.cutoff <- copy(dt)
1607803397638:dt.cutoff <- dt.cutoff[ (freq >= 0) & (mag_ratio <= -3)]
1607803397920:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607803398005:ggplot(dt.cutoff[ (derivative == 0)]) +
1607803398026:geom_line(aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803398047:theme_pander()
1607803445377:ggplot(dt.cutoff[ (derivative == 0)],
1607803445395:aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803445412:geom_line() +
1607803445429:geom_point() +
1607803445446:theme_pander()
1607803537180:scale_color_gradientn
1607803564656:names(canva_palettes)[2]
1607803577856:ggplot(dt.cutoff[ (derivative == 0)],
1607803577874:aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803577892:geom_line() +
1607803577910:geom_point() +
1607803577929:theme_pander() +
1607803577948:scale_color_gratientn(colors=canva_pal("Subdued and proffesional"))
1607803592994:ggplot(dt.cutoff[ (derivative == 0)],
1607803593012:aes(x=as.numeric(order), y=freq, color=width, group=width)) +
1607803593032:geom_line() +
1607803593051:geom_point() +
1607803593075:theme_pander() +
1607803593098:scale_color_gradientn(colors=canva_pal("Subdued and proffesional"))
1607803605130:ggplot(dt.cutoff[ (derivative == 0)],
1607803605148:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803605165:geom_line() +
1607803605181:geom_point() +
1607803605200:theme_pander() +
1607803605217:scale_color_gradientn(colors=canva_pal("Subdued and proffesional"))
1607803612114:dt.cutoff
1607803616745:dt.cutoff[, as.numeric(width)]
1607803622792:canva_pal("Subdued and proffesional")
1607803628737:ggplot(dt.cutoff[ (derivative == 0)],
1607803628755:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803628773:geom_line() +
1607803628788:geom_point() +
1607803628806:theme_pander() +
1607803628820:scale_color_gradientn(colors=canva_pal("Subdued and proffesional")(4))
1607803645417:ggplot(dt.cutoff[ (derivative == 0)],
1607803645437:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803645453:geom_line() +
1607803645471:geom_point() +
1607803645489:theme_pander() +
1607803645507:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[3])(4))
1607803650738:ggplot(dt.cutoff[ (derivative == 0)],
1607803650755:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803650772:geom_line() +
1607803650789:geom_point() +
1607803650806:theme_pander() +
1607803650820:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803743847:dt.cutoff[, estimated := as.numeric(order)/as.numeric(width)]
1607803762034:ggplot(dt.cutoff[ (derivative == 0)],
1607803762051:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803762070:geom_line() +
1607803762088:geom_point(aes(y=estimated)) +
1607803762105:theme_pander() +
1607803762125:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803788681:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(width)-1)/2)]
1607803789001:ggplot(dt.cutoff[ (derivative == 0)],
1607803789018:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803789039:geom_line() +
1607803789058:geom_point(aes(y=estimated)) +
1607803789075:theme_pander() +
1607803789093:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803809104:dt.cutoff[, estimated := ((as.numeric(width)-1)/2)/as.numeric(order)]
1607803809731:ggplot(dt.cutoff[ (derivative == 0)],
1607803809750:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803809770:geom_line() +
1607803809788:geom_point(aes(y=estimated)) +
1607803809807:theme_pander() +
1607803809826:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803814969:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(width)-1)/2)]
1607803815341:ggplot(dt.cutoff[ (derivative == 0)],
1607803815359:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803815379:geom_line() +
1607803815398:geom_point(aes(y=estimated)) +
1607803815414:theme_pander() +
1607803815428:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803821585:ggplot(dt.cutoff[ (derivative == 0)],
1607803821601:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803821617:geom_line() +
1607803821633:#geom_point(aes(y=estimated)) +
1607803821653:theme_pander() +
1607803821671:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607803823411:dt.cutoff <- copy(dt)
1607803823435:dt.cutoff <- dt.cutoff[ (freq >= 0) & (mag_ratio <= -3)]
1607803823463:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607803823511:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(width)-1)/2)]
1607803823540:ggplot(dt.cutoff[ (derivative == 0)],
1607803823560:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607803823579:geom_line() +
1607803823597:#geom_point(aes(y=estimated)) +
1607803823614:theme_pander() +
1607803823633:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(4))
1607804087168:ggplot(dt.cutoff[ (derivative == 0)],
1607804087186:aes(x=as.numeric(order), y=freq, color=as.numeric(width), group=width)) +
1607804087204:geom_line() +
1607804087221:#geom_point(aes(y=estimated)) +
1607804087236:theme_pander() +
1607804087256:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804116889:dt.cutoff
1607804131841:ggplot(dt.cutoff[ (derivative == 0)],
1607804131859:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804131878:geom_line() +
1607804131894:#geom_point(aes(y=estimated)) +
1607804131911:theme_pander() +
1607804131926:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804156264:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(as.character(width))-1)/2)]
1607804161481:ggplot(dt.cutoff[ (derivative == 0)],
1607804161497:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804161512:geom_line() +
1607804161531:geom_point(aes(y=estimated)) +
1607804161546:theme_pander() +
1607804161565:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804172776:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(as.character(width)))/2)]
1607804173402:ggplot(dt.cutoff[ (derivative == 0)],
1607804173418:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804173434:geom_line() +
1607804173451:geom_point(aes(y=estimated)) +
1607804173468:theme_pander() +
1607804173484:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804181550:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(as.character(width))))]
1607804181703:ggplot(dt.cutoff[ (derivative == 0)],
1607804181722:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804181741:geom_line() +
1607804181760:geom_point(aes(y=estimated)) +
1607804181777:theme_pander() +
1607804181795:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804262663:ggplot(dt.cutoff[ (derivative == 0)],
1607804262682:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804262700:geom_line() +
1607804262719:#geom_point(aes(y=estimated)) +
1607804262736:geom_point() +
1607804262754:theme_pander() +
1607804262773:scale_color_gradientn(colors=canva_pal(names(canva_palettes)[4])(2))
1607804273143:ggplot(dt.cutoff[ (derivative == 0)],
1607804273160:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804273176:geom_line() +
1607804273191:#geom_point(aes(y=estimated)) +
1607804273209:geom_point() +
1607804273229:theme_pander() +
1607804273247:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[4])(2))
1607804304788:ggplot(dt.cutoff[ (derivative == 0)],
1607804304810:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804304831:geom_line() +
1607804304847:#geom_point(aes(y=estimated)) +
1607804304864:geom_point() +
1607804304884:theme_pander() +
1607804304903:scale_x_continuous("Grau") +
1607804304921:scale_y_continuous("Frequência de corte") +
1607804304939:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[4])(2))
1607804353887:getwd
1607804356016:getwd()
1607804411666:source('~/.active-rstudio-document', echo=TRUE)
1607804485278:sel.dt <- dt[(order==3) & (width == last(width)) & derivative == 1]
1607804485454:ggplot(sel.dt) +
1607804485474:geom_line(aes(freq, abs(f))) +
1607804485494:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607804485512:xlim(-0.01, 0.01) +
1607804485529:ylim(0, 0.1)
1607804493393:sel.dt <- dt[(order==3) & (width == first(width)) & derivative == 1]
1607804493539:ggplot(sel.dt) +
1607804493568:geom_line(aes(freq, abs(f))) +
1607804493587:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607804493608:xlim(-0.01, 0.01) +
1607804493631:ylim(0, 0.1)
1607804570193:# Chunk 1: setup
1607804570210:knitr::opts_chunk$set(echo = T,
1607804570224:message=FALSE,
1607804570242:warning = F,
1607804570260:results = 'asis',
1607804570276:fig.align='center',  out.height= '100%',
1607804570292:fig.pos='H',
1607804570309:out.width="100%",
1607804570325:fig.margin=F)
1607804570343:options("kableExtra.html.bsTable" = T)
1607804570362:options(tinytex.verbose = TRUE)
1607804570377:options(knitr.kable.NA = "-")
1607804570393:rm(list = setdiff(objects(),c("main.directory","usuario", "params") ))
1607804570425:# Chunk 2
1607804570449:library(ggplot2)
1607804570467:library(data.table)
1607804570487:library(pracma)
1607804570505:library(dplyr)
1607804570522:library(stats)
1607804570540:library(ggthemes)
1607804570555:library(grid)
1607804570572:library(gridExtra)
1607804570603:# Chunk 3
1607804570621:.blue   = "#1D7C96"
1607804570639:.mauve  = "#d46edb"
1607804570657:.orange = "#f27b1f"
1607804570675:.bistre = "#876f5c"
1607804570692:.gray   = "#6b8599"
1607804570726:# Chunk 4
1607804570749:filter.coef <- function(width, order, derivative=0) {
1607804570767:stopifnot(width %% 2 == 1)
1607804570803:# half-width
1607804570820:M <- (width - 1)/2
1607804570838:A <- matrix(0,
1607804570854:nrow=width,
1607804570872:ncol=order)
1607804570896:for (n in 0:(width-1)){
1607804570914:for (i in 0:(order-1)){
1607804570930:A[n+1, i+1] <- (n-M)^i
1607804570947:}
1607804570964:}
1607804570994:H = solve(t(A) %*% A, tol=1e-80) %*% t(A)
1607804571019:return(H[derivative+1,]*factorial(derivative))
1607804571049:}
1607804571080:rep.like <- function(x) {
1607804571100:return(-(length(x)%/%2):(length(x)%/%2))
1607804571117:}
1607804571143:filter <- function(x, filter) {
1607804571161:x <- as.numeric(stats::filter(x, filter, method="convolution"))
1607804571178:x[is.na(x)] <- 0
1607804571197:return(x)
1607804571213:}
1607804571237:fftshift <- function(x) {
1607804571255:l <- length(x)
1607804571280:return(c(x[(l%/%2+1):l],x[1:(l%/%2)]))
1607804571303:#return(c(x[(l%/%2+2):l],x[l%/%2+1], x[1:(l%/%2)]))
1607804571320:}
1607804571351:fftfreq <- function(n, d) {
1607804571376:if (n %% 2 == 0) {
1607804571399:return(c(
1607804571416:0:(n/2-1),
1607804571434:(-n/2):-1) / (d*n))
1607804571455:}
1607804571480:return(c(
1607804571496:0:((n-1)/2),
1607804571513:(-(n-1)/2):-1
1607804571532:)/(d*n))
1607804571549:#f = [0, 1, ...,   n/2-1,     -n/2, ..., -1] / (d*n)   if n is even
1607804571569:#f = [0, 1, ..., (n-1)/2, -(n-1)/2, ..., -1] / (d*n)   if n is odd
1607804571589:}
1607804571617:# Chunk 5
1607804571641:coefs <- filter.coef(15, 6, derivative=1)
1607804571698:data = data.table(x=rep.like(coefs),
1607804571735:y=coefs)
1607804571993:ggplot(data) +
1607804572010:geom_hline(yintercept = 0, color=.gray, alpha=0.5) +
1607804572030:geom_line(aes(x=x, y=y), color=.blue) +
1607804572050:theme_bw()
1607804572218:# Chunk 6
1607804572247:generate.impulse.response <- function(half.size) {
1607804572265:impulse.response <- rep(0, 2*half.size + 1)
1607804572285:impulse.response[half.size+1] <- 1
1607804572302:return(impulse.response)
1607804572318:}
1607804572342:impulse.response <- generate.impulse.response(2000)
1607804572359:coefs <- filter.coef(15, 1)
1607804573120:res <- filter(impulse.response, coefs)
1607804573138:#res <- res[res != 0]
1607804573156:#res <- stats::filter(impulse.response, coefs, method="convolution")
1607804573174:res <- log10(abs(fft(res)))
1607804573219:data.frame(y=res,
1607804573239:x=fftfreq(length(res), d=1)) %>%
1607804573257:ggplot(., aes(x, y)) +
1607804573273:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607804573290:geom_line(color=.blue) +
1607804573307:theme_pander()
1607804573581:# Chunk 7
1607804573599:widths <- seq(11, 300, 20)
1607804573618:orders <- seq(3, 10, 2)
1607804573643:impulse.response <- generate.impulse.response(2000)
1607804574603:dt <- data.table()
1607804574622:for (derivative in 0:2) {
1607804574651:for (order in orders[orders > derivative]){
1607804574671:for (width in widths[widths > order*2]) {
1607804574695:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607804574715:res <- filter(impulse.response, coefs)
1607804574734:res.log <- log10(abs(fft(res)))
1607804574752:freqs <- fftfreq(length(res), d=1)
1607804574787:dt <- rbind(dt,
1607804574804:data.table(y= as.numeric(res.log),
1607804574821:f=fft(res),
1607804574839:freq=freqs,
1607804574857:width = width,
1607804574877:order = order,
1607804574894:derivative = derivative))
1607804574912:}
1607804574939:}
1607804574966:}
1607804582955:dt[, y_ideal := (freq*pi*2)^derivative]
1607804582997:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607804583031:dt[, width := factor(as.factor(width), levels=widths)]
1607804583654:dt[, order := factor(as.factor(order), levels=orders)]
1607804584183:plot.magnitudes <- function(dt, derivative, title="") {
1607804584207:.derivative <- derivative
1607804584224:g.widths <- ggplot(dt[(freq>0) & (order == first(order)) & (derivative == .derivative)],
1607804584242:aes(freq, mag_ratio, color=width)) +
1607804584261:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607804584277:geom_line() +
1607804584294:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607804584313:theme_pander() +
1607804584332:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607804584350:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607804584369:scale_y_continuous(name="Logaritmo da magnitude")
1607804584401:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607804584416:aes(freq, mag_ratio, color=order)) +
1607804584431:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607804584450:geom_line() +
1607804584469:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607804584487:theme_pander() +
1607804584505:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607804584524:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607804584543:scale_y_continuous(name="Logaritmo da magnitude")
1607804584577:return(arrangeGrob(g.widths, g.orders, nrow=2,
1607804584600:top=textGrob(title,gp=gpar(fontsize=20,font=3))
1607804584622:)
1607804584641:)
1607804584658:}
1607804584683:# Chunk 8
1607804584706:g.der0 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG")
1607804585414:g.der1 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=1, title="SG 1a ordem")
1607804585662:g.der2 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=2, title="SG 2a ordem")
1607804585923:# Chunk 9
1607804585940:g.der0 %>% grid.draw
1607804586094:# Chunk 10
1607804586113:g.der1 %>% grid.draw
1607804586264:# Chunk 11
1607804586283:g.der2 %>% grid.draw
1607804586433:# Chunk 12
1607804586457:sel.dt <- dt[(order==3) & (width == last(width)) & derivative == 1]
1607804591589:ggplot(sel.dt) +
1607804591606:geom_line(aes(freq, abs(f))) +
1607804591623:geom_line(aes(x=freq, y=abs(freq)*pi*2), color = .gray) +
1607804591641:xlim(-0.01, 0.01) +
1607804591658:ylim(0, 0.1)
1607804591921:# Chunk 13
1607804591946:dt.cutoff <- copy(dt)
1607804591993:dt.cutoff <- dt.cutoff[ (freq >= 0) & (mag_ratio <= -3)]
1607804592023:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607804593100:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(as.character(width))))]
1607804593206:g.cutoff <- ggplot(dt.cutoff[ (derivative == 0)],
1607804593223:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804593241:geom_line() +
1607804593259:#geom_point(aes(y=estimated)) +
1607804593276:geom_point() +
1607804593293:theme_pander() +
1607804593309:scale_x_continuous("Grau") +
1607804593327:scale_y_continuous("Frequência de corte") +
1607804593343:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[4])(2))
1607804865630:plot.cutoff <- function(derivative) {
1607804865650:.derivative <- derivative
1607804865668:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607804865684:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804865701:geom_line() +
1607804865716:#geom_point(aes(y=estimated)) +
1607804865734:geom_point() +
1607804865753:theme_pander() +
1607804865769:scale_x_continuous("Grau") +
1607804865789:scale_y_continuous("Frequência de corte") +
1607804865807:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[4])(2))
1607804865825:return(g)
1607804865845:}
1607804872669:g.cutoff.der0 <- plot.cutoff(0)
1607804875742:plot(g.cutoff.der0)
1607804889685:g.cutoff.der2 <- plot.cutoff(2)
1607804897441:plot(g.cutoff.der0)
1607804897660:plot(g.cutoff.der1)
1607804898760:plot(g.cutoff.der2)
1607804901732:g.cutoff.der1 <- plot.cutoff(1)
1607804901926:g.cutoff.der2 <- plot.cutoff(2)
1607804902470:plot(g.cutoff.der0)
1607804902690:plot(g.cutoff.der1)
1607804903849:plot(g.cutoff.der2)
1607804918308:ggsave(paste0(save.at, "savitzky-golay-cutoff-der2.png"), g.cutoff.der2)
1607804922663:save.at <- c("~/R/images")
1607804922808:dir.create(save.at)
1607804922965:ggsave(paste0(save.at, "savitzky-golay-der0.png"), g.der0)
1607804923580:ggsave(paste0(save.at, "savitzky-golay-der1.png"), g.der1)
1607804924168:ggsave(paste0(save.at, "savitzky-golay-der2.png"), g.der2)
1607804924604:ggsave(paste0(save.at, "savitzky-golay-cutoff-der0.png"), g.cutoff.der0)
1607804924981:ggsave(paste0(save.at, "savitzky-golay-cutoff-der1.png"), g.cutoff.der1)
1607804925373:ggsave(paste0(save.at, "savitzky-golay-cutoff-der2.png"), g.cutoff.der2)
1607804982911:plot.cutoff <- function(derivative) {
1607804982929:.derivative <- derivative
1607804982947:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607804982965:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804982983:geom_line() +
1607804983001:#geom_point(aes(y=estimated)) +
1607804983020:geom_point() +
1607804983038:theme_pander() +
1607804983057:scale_x_continuous("Grau") +
1607804983075:scale_y_continuous("Frequência de corte") +
1607804983094:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[5])(2))
1607804983112:return(g)
1607804983134:}
1607804983589:g.cutoff.der0 <- plot.cutoff(0)
1607804984990:plot(g.cutoff.der0)
1607804991684:plot.cutoff <- function(derivative) {
1607804991701:.derivative <- derivative
1607804991722:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607804991741:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607804991759:geom_line() +
1607804991778:#geom_point(aes(y=estimated)) +
1607804991796:geom_point() +
1607804991814:theme_pander() +
1607804991834:scale_x_continuous("Grau") +
1607804991851:scale_y_continuous("Frequência de corte") +
1607804991867:scale_color_gradientn("largura", colors=canva_pal(names(canva_palettes)[4])(3))
1607804991884:return(g)
1607804991903:}
1607804991923:g.cutoff.der0 <- plot.cutoff(0)
1607804992796:plot(g.cutoff.der0)
1607805005599:names(canva_palettes)[4])(2)
1607805015771:canvas_pal(names(canva_palettes)[4]))(2)
1607805021226:canva_pal(names(canva_palettes)[4])(2)
1607805058269:plot.cutoff <- function(derivative) {
1607805058287:.derivative <- derivative
1607805058304:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805058319:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805058336:geom_line() +
1607805058353:#geom_point(aes(y=estimated)) +
1607805058372:geom_point() +
1607805058390:theme_pander() +
1607805058407:scale_x_continuous("Grau") +
1607805058423:scale_y_continuous("Frequência de corte") +
1607805058440:scale_color_gradientn("largura", colors=c("#93b6db", "#505160"))
1607805058458:return(g)
1607805058477:}
1607805058654:g.cutoff.der0 <- plot.cutoff(0)
1607805059701:plot(g.cutoff.der0)
1607805102884:plot(g.cutoff.der0 + ylim(0, 0.06))
1607805139597:dt.cutoff[freq <0.1]
1607805140481:plot.cutoff <- function(derivative) {
1607805140504:.derivative <- derivative
1607805140523:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805140541:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805140561:geom_line() +
1607805140579:#geom_point(aes(y=estimated)) +
1607805140597:geom_point() +
1607805140616:theme_pander() +
1607805140633:scale_x_continuous("Grau") +
1607805140650:scale_y_continuous("Frequência de corte") +
1607805140669:scale_color_gradientn("largura", colors=c("#93b6db", "#505160"))
1607805140686:return(g)
1607805140706:}
1607805141628:g.cutoff.der0 <- plot.cutoff(0)
1607805142740:plot(g.cutoff.der0)
1607805151645:dt.cutoff <- dt.cutoff[freq <0.1]
1607805151923:plot.cutoff <- function(derivative) {
1607805151940:.derivative <- derivative
1607805151958:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805151977:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805151997:geom_line() +
1607805152016:#geom_point(aes(y=estimated)) +
1607805152035:geom_point() +
1607805152051:theme_pander() +
1607805152071:scale_x_continuous("Grau") +
1607805152091:scale_y_continuous("Frequência de corte") +
1607805152110:scale_color_gradientn("largura", colors=c("#93b6db", "#505160"))
1607805152126:return(g)
1607805152143:}
1607805152238:g.cutoff.der0 <- plot.cutoff(0)
1607805153575:plot(g.cutoff.der0)
1607805160564:g.cutoff.der1 <- plot.cutoff(1)
1607805160772:g.cutoff.der2 <- plot.cutoff(2)
1607805161693:plot(g.cutoff.der1)
1607805166912:plot(g.cutoff.der2)
1607805194149:plot.cutoff <- function(derivative) {
1607805194168:.derivative <- derivative
1607805194186:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805194203:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805194221:geom_line() +
1607805194237:#geom_point(aes(y=estimated)) +
1607805194253:geom_point() +
1607805194269:theme_pander() +
1607805194287:scale_x_continuous("Grau") +
1607805194304:scale_y_continuous("Frequência de corte") +
1607805194322:scale_color_gradientn("largura", colors=c("#93b6db", "#505160")) +
1607805194341:coord_cartesian(ylim=c(NA, 0.1))
1607805194360:return(g)
1607805194379:}
1607805194427:g.cutoff.der0 <- plot.cutoff(0)
1607805195549:plot(g.cutoff.der0)
1607805197844:g.cutoff.der1 <- plot.cutoff(1)
1607805198820:plot(g.cutoff.der1)
1607805210515:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805210533:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805210552:geom_line() +
1607805210572:#geom_point(aes(y=estimated)) +
1607805210587:geom_point() +
1607805210602:theme_pander() +
1607805210624:scale_x_continuous("Grau") +
1607805210644:scale_y_continuous("Frequência de corte") +
1607805210663:scale_color_gradientn("largura", colors=c("#93b6db", "#505160")) +
1607805210678:coord_cartesian(ylim=c(NA, 0.12))
1607805211674:plot.cutoff <- function(derivative) {
1607805211693:.derivative <- derivative
1607805211710:g <- ggplot(dt.cutoff[ (derivative == .derivative)],
1607805211726:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805211741:geom_line() +
1607805211756:#geom_point(aes(y=estimated)) +
1607805211772:geom_point() +
1607805211791:theme_pander() +
1607805211810:scale_x_continuous("Grau") +
1607805211829:scale_y_continuous("Frequência de corte") +
1607805211849:scale_color_gradientn("largura", colors=c("#93b6db", "#505160")) +
1607805211866:coord_cartesian(ylim=c(NA, 0.12))
1607805211882:return(g)
1607805211898:}
1607805211918:g.cutoff.der0 <- plot.cutoff(0)
1607805212084:g.cutoff.der1 <- plot.cutoff(1)
1607805212378:g.cutoff.der2 <- plot.cutoff(2)
1607805212533:plot(g.cutoff.der0)
1607805213863:plot(g.cutoff.der1)
1607805235421:plot.cutoff <- function(derivative) {
1607805235440:.derivative <- derivative
1607805235456:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607805235475:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805235492:geom_line() +
1607805235510:#geom_point(aes(y=estimated)) +
1607805235528:geom_point() +
1607805235547:theme_pander() +
1607805235564:scale_x_continuous("Grau") +
1607805235583:scale_y_continuous("Frequência de corte") +
1607805235599:scale_color_gradientn("largura", colors=c("#93b6db", "#505160")) +
1607805235616:coord_cartesian(ylim=c(NA, 0.12))
1607805235634:return(g)
1607805235652:}
1607805235769:g.cutoff.der0 <- plot.cutoff(0)
1607805235956:g.cutoff.der1 <- plot.cutoff(1)
1607805236450:g.cutoff.der2 <- plot.cutoff(2)
1607805236580:plot(g.cutoff.der0)
1607805237908:plot(g.cutoff.der1)
1607805275068:plot.cutoff <- function(derivative) {
1607805275086:.derivative <- derivative
1607805275103:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607805275121:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805275136:geom_line() +
1607805275151:#geom_point(aes(y=estimated)) +
1607805275169:geom_point() +
1607805275184:theme_pander() +
1607805275205:scale_x_continuous("Grau") +
1607805275223:scale_y_continuous("Frequência de corte") +
1607805275240:scale_color_stepsn("largura", colors=c("#93b6db", "#505160")) +
1607805275257:coord_cartesian(ylim=c(NA, 0.12))
1607805275274:return(g)
1607805275291:}
1607805275530:g.cutoff.der0 <- plot.cutoff(0)
1607805276973:plot(g.cutoff.der0)
1607805286614:g.cutoff.der1 <- plot.cutoff(1)
1607805288190:g.cutoff.der2 <- plot.cutoff(2)
1607805291847:plot(g.cutoff.der1)
1607805292146:plot(g.cutoff.der2)
1607805363172:plot.cutoff <- function(derivative) {
1607805363198:.derivative <- derivative
1607805363218:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607805363237:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805363255:geom_line() +
1607805363273:#geom_point(aes(y=estimated)) +
1607805363289:geom_point() +
1607805363306:theme_pander() +
1607805363322:scale_x_continuous("Grau") +
1607805363338:scale_y_continuous("Frequência de corte") +
1607805363354:scale_color_stepsn("largura", colors=c("#bfdeff", "#93b6db", "#505160")) +
1607805363368:coord_cartesian(ylim=c(NA, 0.12))
1607805363384:return(g)
1607805363402:}
1607805363424:g.cutoff.der0 <- plot.cutoff(0)
1607805364291:plot(g.cutoff.der0)
1607805366830:g.cutoff.der1 <- plot.cutoff(1)
1607805367876:g.cutoff.der2 <- plot.cutoff(2)
1607805368531:plot(g.cutoff.der0)
1607805370380:plot(g.cutoff.der1)
1607805377423:}
1607805377605:g.cutoff.der1 <- plot.cutoff(1)
1607805377942:g.cutoff.der2 <- plot.cutoff(2)
1607805378079:plot(g.cutoff.der0)
1607805383764:plot.cutoff <- function(derivative) {
1607805383783:.derivative <- derivative
1607805383798:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607805383815:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805383834:geom_line() +
1607805383853:#geom_point(aes(y=estimated)) +
1607805383874:geom_point() +
1607805383892:theme_pander() +
1607805383909:scale_x_continuous("Grau") +
1607805383925:scale_y_continuous("Frequência de corte") +
1607805383943:scale_color_stepsn("largura", colors=c("#93b6db", "#505160")) +
1607805383963:coord_cartesian(ylim=c(NA, 0.12))
1607805383981:return(g)
1607805383999:}
1607805384020:g.cutoff.der0 <- plot.cutoff(0)
1607805384168:g.cutoff.der1 <- plot.cutoff(1)
1607805384196:g.cutoff.der2 <- plot.cutoff(2)
1607805384446:plot(g.cutoff.der0)
1607805385720:plot(g.cutoff.der1)
1607805386887:plot(g.cutoff.der2)
1607805389910:?scale_color_stepsn
1607805424248:plot.cutoff <- function(derivative) {
1607805424265:.derivative <- derivative
1607805424282:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607805424300:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607805424318:geom_line() +
1607805424336:#geom_point(aes(y=estimated)) +
1607805424354:geom_point() +
1607805424372:theme_pander() +
1607805424389:scale_x_continuous("Grau") +
1607805424407:scale_y_continuous("Frequência de corte") +
1607805424427:scale_color_stepsn("largura", colors=c("#93b6db", "#505160"), n.breaks=5, nice.breaks=T) +
1607805424445:coord_cartesian(ylim=c(NA, 0.12))
1607805424462:return(g)
1607805424481:}
1607805424499:g.cutoff.der0 <- plot.cutoff(0)
1607805425531:plot(g.cutoff.der0)
1607807282058:widths <- seq(11, 300, 20)
1607807282082:orders <- seq(3, 12, 2)
1607807282107:impulse.response <- generate.impulse.response(2000)
1607807282150:dt <- data.table()
1607807282169:for (derivative in 0:2) {
1607807282194:for (order in orders[orders > derivative]){
1607807282212:for (width in widths[widths > order*2]) {
1607807282230:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607807282246:res <- filter(impulse.response, coefs)
1607807282264:res.log <- log10(abs(fft(res)))
1607807282286:freqs <- fftfreq(length(res), d=1)
1607807282313:dt <- rbind(dt,
1607807282332:data.table(y= as.numeric(res.log),
1607807282350:f=fft(res),
1607807282369:freq=freqs,
1607807282386:width = width,
1607807282403:order = order,
1607807282421:derivative = derivative))
1607807282439:}
1607807282462:}
1607807282488:}
1607807294067:dt[, y_ideal := (freq*pi*2)^derivative]
1607807294099:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607807294142:dt[, width := factor(as.factor(width), levels=widths)]
1607807294874:dt[, order := factor(as.factor(order), levels=orders)]
1607807295561:plot.magnitudes <- function(dt, derivative, title="") {
1607807295588:.derivative <- derivative
1607807295609:.order <- dt[, first(order)]
1607807295628:.width <- dt[, first(width)]
1607807295654:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607807295675:aes(freq, mag_ratio, color=width)) +
1607807295694:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807295712:geom_line() +
1607807295729:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807295747:theme_pander() +
1607807295765:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607807295784:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807295802:scale_y_continuous(name="Logaritmo da magnitude") +
1607807295824:ggtitle(paste0("grau = ", .order))
1607807295865:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607807295888:aes(freq, mag_ratio, color=order)) +
1607807295910:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807295929:geom_line() +
1607807295947:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807295965:theme_pander() +
1607807295984:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607807296002:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807296020:scale_y_continuous(name="")+
1607807296040:ggtitle(paste0("largura = ", .width))
1607807296073:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607807296099:}
1607807296120:g.der0 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG")
1607807296805:g.der1 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=1, title="SG 1a ordem")
1607807297096:g.der2 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=2, title="SG 2a ordem")
1607807304903:g.der0 %>% grid.draw
1607807707489:plot.magnitudes <- function(dt, derivative, title="") {
1607807707518:.derivative <- derivative
1607807707538:.order <- dt[, first(order)]
1607807707565:.width <- dt[width > 2*max(as.numeric(as.character(order))), first(width)]
1607807707601:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607807707625:aes(freq, mag_ratio, color=width)) +
1607807707649:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807707674:geom_line() +
1607807707703:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807707723:theme_pander() +
1607807707744:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607807707767:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807707786:scale_y_continuous(name="Logaritmo da magnitude") +
1607807707805:ggtitle(paste0("grau = ", .order))
1607807707859:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607807707879:aes(freq, mag_ratio, color=order)) +
1607807707906:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807707925:geom_line() +
1607807707947:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807707970:theme_pander() +
1607807707990:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607807708012:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807708033:scale_y_continuous(name="")+
1607807708052:ggtitle(paste0("largura = ", .width))
1607807708093:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607807708135:}
1607807711931:g.der0 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG")
1607807759480:to.numeric <- function(x) as.numeric(as.character(x))
1607807759655:plot.magnitudes <- function(dt, derivative, title="") {
1607807759700:.derivative <- derivative
1607807759729:.order <- dt[, first(order)]
1607807759758:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607807759810:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607807759829:aes(freq, mag_ratio, color=width)) +
1607807759857:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807759890:geom_line() +
1607807759983:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807760052:theme_pander() +
1607807760109:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607807760183:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807760228:scale_y_continuous(name="Logaritmo da magnitude") +
1607807760276:ggtitle(paste0("grau = ", .order))
1607807760337:g.orders <- ggplot(dt[(freq>0) & (width == first(width)) & (derivative == .derivative)],
1607807760357:aes(freq, mag_ratio, color=order)) +
1607807760374:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607807760390:geom_line() +
1607807760414:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607807760442:theme_pander() +
1607807760463:scale_color_canva("ordem", palette = names(canva_palettes)[3]) +
1607807760482:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607807760505:scale_y_continuous(name="")+
1607807760537:ggtitle(paste0("largura = ", .width))
1607807760582:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607807760617:}
1607807760642:}
1607807760663:```{r}
1607807760692:g.der0 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=0, title="SG")
1607807761206:g.der1 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=1, title="SG 1a ordem")
1607807761688:g.der2 <- plot.magnitudes(dt[width %in% c(11, 71, 131, 191)], derivative=2, title="SG 2a ordem")
1607807762428:```{r}
1607807764312:g.der0 %>% grid.draw
1607807810915:dt[, unique(order)]
1607808598682:dt[width %in% c(11, 31, 71, 131), unique(order)]
1607808606617:dt[width == 71, unique(order)]
1607808617415:dt[width == 71,][order==9]
1607809396178:.dt <- dt[(freq >0 ) & (width == 71) & (derivative = 0)]
1607809405807:ggplot(.dt,
1607809405823:aes(freq, mag_ratio, color=order)) +
1607809405840:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809405857:geom_line() +
1607809405874:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809405893:theme_pander() +
1607809405911:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607809405931:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809405947:scale_y_continuous(name="")+
1607809405965:ggtitle(paste0("largura = ", .width))
1607809416190:ggplot(.dt,
1607809416206:aes(freq, mag_ratio, color=order)) +
1607809416224:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809416242:geom_line() +
1607809416262:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809416279:theme_pander() +
1607809416293:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607809416310:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809416327:scale_y_continuous(name="")
1607809419982:.dt
1607809429676:.dt <- dt[(freq >0 ) & (width == 71) & (derivative == 0)]
1607809430920:ggplot(.dt,
1607809430936:aes(freq, mag_ratio, color=order)) +
1607809430954:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809430974:geom_line() +
1607809430993:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809431009:theme_pander() +
1607809431025:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607809431041:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809431058:scale_y_continuous(name="")
1607809456205:.dt <- dt[(freq >0 ) & (width == 71) & (derivative == 1)]
1607809458116:ggplot(.dt,
1607809458133:aes(freq, mag_ratio, color=order)) +
1607809458151:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809458168:geom_line() +
1607809458184:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809458200:theme_pander() +
1607809458217:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607809458233:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809458251:scale_y_continuous(name="")
1607809482630:plot.magnitudes <- function(dt, derivative, title="") {
1607809482655:.derivative <- derivative
1607809482672:.order <- dt[, first(order)]
1607809482693:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607809482719:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607809482736:aes(freq, mag_ratio, color=width)) +
1607809482752:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809482770:geom_line() +
1607809482788:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809482806:theme_pander() +
1607809482825:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607809482845:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809482863:scale_y_continuous(name="Logaritmo da magnitude") +
1607809482881:ggtitle(paste0("grau = ", .order))
1607809482924:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607809482944:aes(freq, mag_ratio, color=order)) +
1607809482963:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607809482985:geom_line() +
1607809483005:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607809483022:theme_pander() +
1607809483039:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607809483055:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607809483071:scale_y_continuous(name="")+
1607809483087:ggtitle(paste0("largura = ", .width))
1607809483118:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607809483141:}
1607809486212:g.der0 <- plot.magnitudes(dt[width %in% c(11, 31, 71, 131)], derivative=0, title="SG")
1607809487074:g.der1 <- plot.magnitudes(dt[width %in% c(11, 31, 71, 131)], derivative=1, title="SG 1a ordem")
1607809488032:g.der2 <- plot.magnitudes(dt[width %in% c(11, 31, 71, 131)], derivative=2, title="SG 2a ordem")
1607809488747:```{r}
1607809488767:g.der0 %>% grid.draw
1607809562691:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607809563164:g.der0 <- plot.magnitudes(sel.dt, derivative=0, title="SG")
1607809565445:g.der0
1607809569748:g.der0 %>% grid.draw
1607812103570:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812103598:.derivative <- derivative
1607812103618:.order <- dt[, first(order)]
1607812103639:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812103670:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812103687:aes(freq, y, color=width)) +
1607812103707:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812103729:geom_line() +
1607812103749:geom_line(aes(y=y_ideal), linetype="dashed") +
1607812103770:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812103787:theme_pander() +
1607812103806:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812103830:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812103855:scale_y_continuous(name="Logaritmo da magnitude") +
1607812103879:ggtitle(paste0("grau = ", .order))
1607812103935:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812103959:aes(freq, mag_ratio, color=order)) +
1607812103980:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812104000:geom_line() +
1607812104021:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812104044:theme_pander() +
1607812104060:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812104078:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812104096:scale_y_continuous(name="")+
1607812104112:ggtitle(paste0("largura = ", .width))
1607812104145:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812104172:}
1607812109467:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812113588:plot.magnitudes2(sel.dt, derivative=0, title="SG")
1607812119351:plot.magnitudes2(sel.dt, derivative=0, title="SG")  %>% plot
1607812133341:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812133370:.derivative <- derivative
1607812133392:.order <- dt[, first(order)]
1607812133414:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812133440:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812133462:aes(freq, y, color=width)) +
1607812133484:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812133505:geom_line() +
1607812133528:geom_line(aes(y=y_ideal), linetype="dashed") +
1607812133546:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812133566:theme_pander() +
1607812133585:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812133604:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812133620:scale_y_continuous(name="Logaritmo da magnitude") +
1607812133640:ggtitle(paste0("grau = ", .order))
1607812133678:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812133697:aes(freq, mag_ratio, color=order)) +
1607812133714:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812133735:geom_line() +
1607812133753:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812133771:theme_pander() +
1607812133789:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812133808:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812133824:scale_y_continuous(name="")+
1607812133845:ggtitle(paste0("largura = ", .width))
1607812133879:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812133903:}
1607812135123:plot.magnitudes2(sel.dt, derivative=0, title="SG")  %>% plot
1607812162874:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812162900:.derivative <- derivative
1607812162922:.order <- dt[, first(order)]
1607812162941:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812162969:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812162988:aes(freq, y, color=width)) +
1607812163008:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812163029:geom_line() +
1607812163053:geom_line(aes(y=10*log10(y_ideal)), linetype="dashed") +
1607812163078:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812163102:theme_pander() +
1607812163125:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812163148:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812163172:scale_y_continuous(name="Logaritmo da magnitude") +
1607812163192:ggtitle(paste0("grau = ", .order))
1607812163239:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812163259:aes(freq, mag_ratio, color=order)) +
1607812163279:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812163296:geom_line() +
1607812163317:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812163336:theme_pander() +
1607812163356:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812163377:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812163401:scale_y_continuous(name="")+
1607812163420:ggtitle(paste0("largura = ", .width))
1607812163452:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812163478:}
1607812164652:plot.magnitudes2(sel.dt, derivative=0, title="SG")  %>% plot
1607812212701:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812212725:.derivative <- derivative
1607812212742:.order <- dt[, first(order)]
1607812212762:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812212790:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812212809:aes(freq, y, color=width)) +
1607812212827:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812212845:geom_line() +
1607812212864:geom_line(aes(y=10*log10(y_ideal)), linetype="solid") +
1607812212884:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812212905:theme_pander() +
1607812212924:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812212942:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812212959:scale_y_continuous(name="Logaritmo da magnitude") +
1607812212979:ggtitle(paste0("grau = ", .order))
1607812213016:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812213036:aes(freq,y, color=order)) +
1607812213055:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812213074:geom_line() +
1607812213095:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812213114:geom_line(aes(y=10*log10(y_ideal)), linetype="solid") +
1607812213135:theme_pander() +
1607812213153:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812213170:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812213188:scale_y_continuous(name="")+
1607812213206:ggtitle(paste0("largura = ", .width))
1607812213237:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812213265:}
1607812215333:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812215694:plot.magnitudes2(sel.dt, derivative=0, title="SG")  %>% plot
1607812224773:plot.magnitudes2(sel.dt, derivative=1)  %>% plot
1607812644635:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812660491:dt[, y_ideal := (freq*pi*2)^derivative]
1607812665482:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812666011:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812693845:widths <- seq(11, 300, 20)
1607812693864:orders <- seq(3, 12, 2)
1607812693893:impulse.response <- generate.impulse.response(2000)
1607812693937:dt <- data.table()
1607812693953:for (derivative in 0:2) {
1607812693975:for (order in orders[orders > derivative]){
1607812693990:for (width in widths[widths > order*2]) {
1607812694007:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607812694023:res <- filter(impulse.response, coefs)
1607812694040:res.log <- log10(abs(fft(res)))
1607812694057:freqs <- fftfreq(length(res), d=1)
1607812694082:dt <- rbind(dt,
1607812694099:data.table(y= as.numeric(res.log),
1607812694117:f=fft(res),
1607812694136:freq=freqs,
1607812694153:width = width,
1607812694171:order = order,
1607812694188:derivative = derivative))
1607812694206:}
1607812694230:}
1607812694260:}
1607812707502:dt[, y_ideal := (freq*pi*2)^derivative]
1607812707787:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607812707834:dt[, width := factor(as.factor(width), levels=widths)]
1607812708602:dt[, order := factor(as.factor(order), levels=orders)]
1607812709285:to.numeric <- function(x) as.numeric(as.character(x))
1607812709301:plot.magnitudes <- function(dt, derivative, title="") {
1607812709322:.derivative <- derivative
1607812709339:.order <- dt[, first(order)]
1607812709356:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812709379:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812709396:aes(freq, mag_ratio, color=width)) +
1607812709414:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812709433:geom_line() +
1607812709449:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812709464:theme_pander() +
1607812709485:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812709504:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812709520:scale_y_continuous(name="Logaritmo da magnitude") +
1607812709538:ggtitle(paste0("grau = ", .order))
1607812709576:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812709592:aes(freq, mag_ratio, color=order)) +
1607812709610:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812709629:geom_line() +
1607812709645:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812709663:theme_pander() +
1607812709680:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812709697:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812709716:scale_y_continuous(name="")+
1607812709735:ggtitle(paste0("largura = ", .width))
1607812709767:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812709793:}
1607812709825:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812709854:.derivative <- derivative
1607812709878:.order <- dt[, first(order)]
1607812709896:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812709920:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812709937:aes(freq, y, color=width)) +
1607812709956:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812709973:geom_line() +
1607812709995:geom_line(aes(y=y_ideal), linetype="solid") +
1607812710012:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812710031:theme_pander() +
1607812710048:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812710066:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812710086:scale_y_continuous(name="Logaritmo da magnitude") +
1607812710108:ggtitle(paste0("grau = ", .order))
1607812710166:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812710190:aes(freq,y, color=order)) +
1607812710210:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812710233:geom_line() +
1607812710251:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812710270:geom_line(aes(y=10*log10(y_ideal)), linetype="solid") +
1607812710302:theme_pander() +
1607812710327:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812710351:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812710381:scale_y_continuous(name="")+
1607812710404:ggtitle(paste0("largura = ", .width))
1607812710440:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812710467:}
1607812764573:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812765234:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812816762:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812816788:.derivative <- derivative
1607812816810:.order <- dt[, first(order)]
1607812816828:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812816855:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812816871:aes(freq, f, color=width)) +
1607812816890:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812816907:geom_line() +
1607812816926:geom_line(aes(y=y_ideal), linetype="solid") +
1607812816943:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812816961:theme_pander() +
1607812816979:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812816997:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812817014:scale_y_continuous(name="Logaritmo da magnitude") +
1607812817033:ggtitle(paste0("grau = ", .order))
1607812817074:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812817093:aes(freq, f, color=order)) +
1607812817112:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812817128:geom_line() +
1607812817147:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812817163:geom_line(aes(y=10*log10(y_ideal)), linetype="solid") +
1607812817181:theme_pander() +
1607812817199:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812817217:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812817234:scale_y_continuous(name="")+
1607812817252:ggtitle(paste0("largura = ", .width))
1607812817283:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812817309:}
1607812818778:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812818940:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812854899:for (derivative in 0:2) {
1607812854926:for (order in orders[orders > derivative]){
1607812854941:for (width in widths[widths > order*2]) {
1607812854959:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607812854974:res <- filter(impulse.response, coefs)
1607812854991:res.log <- log10(abs(fft(res)))
1607812855007:freqs <- fftfreq(length(res), d=1)
1607812855030:dt <- rbind(dt,
1607812855047:data.table(y= as.numeric(res.log),
1607812855066:f=fft(res),
1607812855084:fft_abs = abs(fft(res)),
1607812855102:freq=freqs,
1607812855121:width = width,
1607812855141:order = order,
1607812855160:derivative = derivative))
1607812855177:}
1607812855200:}
1607812855226:}
1607812857834:dt <- data.table()
1607812857978:for (derivative in 0:2) {
1607812858003:for (order in orders[orders > derivative]){
1607812858021:for (width in widths[widths > order*2]) {
1607812858039:coefs <- filter.coef(width=width, order=order, derivative=derivative)
1607812858056:res <- filter(impulse.response, coefs)
1607812858074:res.log <- log10(abs(fft(res)))
1607812858093:freqs <- fftfreq(length(res), d=1)
1607812858117:dt <- rbind(dt,
1607812858136:data.table(y= as.numeric(res.log),
1607812858153:f=fft(res),
1607812858174:fft_abs = abs(fft(res)),
1607812858194:freq=freqs,
1607812858212:width = width,
1607812858231:order = order,
1607812858248:derivative = derivative))
1607812858267:}
1607812858292:}
1607812858318:}
1607812875501:dt[, y_ideal := (freq*pi*2)^derivative]
1607812875534:dt[, mag_ratio := 10*log10(abs(f)/abs(y_ideal))]
1607812875580:dt[, width := factor(as.factor(width), levels=widths)]
1607812876353:dt[, order := factor(as.factor(order), levels=orders)]
1607812877495:to.numeric <- function(x) as.numeric(as.character(x))
1607812877513:plot.magnitudes <- function(dt, derivative, title="") {
1607812877539:.derivative <- derivative
1607812877557:.order <- dt[, first(order)]
1607812877575:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812877599:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812877617:aes(freq, mag_ratio, color=width)) +
1607812877634:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812877652:geom_line() +
1607812877671:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812877690:theme_pander() +
1607812877708:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812877725:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812877742:scale_y_continuous(name="Logaritmo da magnitude") +
1607812877759:ggtitle(paste0("grau = ", .order))
1607812877851:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812877867:aes(freq, mag_ratio, color=order)) +
1607812877885:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812877901:geom_line() +
1607812877921:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812877938:theme_pander() +
1607812877956:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812877974:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812877991:scale_y_continuous(name="")+
1607812878008:ggtitle(paste0("largura = ", .width))
1607812878045:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812878073:}
1607812886276:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812886302:.derivative <- derivative
1607812886322:.order <- dt[, first(order)]
1607812886340:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812886365:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812886381:aes(freq, fft_abs, color=width)) +
1607812886399:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812886415:geom_line() +
1607812886433:geom_line(aes(y=y_ideal), linetype="solid") +
1607812886450:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812886468:theme_pander() +
1607812886486:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812886505:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812886522:scale_y_continuous(name="Logaritmo da magnitude") +
1607812886540:ggtitle(paste0("grau = ", .order))
1607812886579:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812886598:aes(freq, fft_abs, color=order)) +
1607812886621:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812886639:geom_line() +
1607812886656:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812886673:geom_line(aes(y=10*log10(y_ideal)), linetype="solid") +
1607812886692:theme_pander() +
1607812886711:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812886730:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812886751:scale_y_continuous(name="")+
1607812886771:ggtitle(paste0("largura = ", .width))
1607812886802:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812886828:}
1607812888449:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812888593:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812929172:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812929199:.derivative <- derivative
1607812929216:.order <- dt[, first(order)]
1607812929235:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812929258:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812929278:aes(freq, fft_abs, color=width)) +
1607812929296:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812929314:geom_line() +
1607812929331:geom_line(aes(y=y_ideal), linetype="solid") +
1607812929349:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812929366:theme_pander() +
1607812929383:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812929401:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812929421:scale_y_continuous(name="Logaritmo da magnitude") +
1607812929439:ggtitle(paste0("grau = ", .order))
1607812929475:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812929492:aes(freq, fft_abs, color=order)) +
1607812929512:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812929531:geom_line() +
1607812929549:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812929566:geom_line(aes(y=y_ideal), linetype="solid") +
1607812929584:theme_pander() +
1607812929603:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812929620:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812929638:scale_y_continuous(name="")+
1607812929659:ggtitle(paste0("largura = ", .width))
1607812929690:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812929711:}
1607812932224:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812933851:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812973713:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812973738:.derivative <- derivative
1607812973756:.order <- dt[, first(order)]
1607812973772:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812973797:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812973816:aes(freq, fft_abs, color=width)) +
1607812973833:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812973852:geom_line() +
1607812973867:geom_line(aes(y=y_ideal), linetype="solid") +
1607812973883:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812973898:theme_pander() +
1607812973917:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812973933:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812973948:scale_y_continuous(name="Logaritmo da magnitude") +
1607812973966:ggtitle(paste0("grau = ", .order)) +
1607812973985:xlim(0, 0.05)
1607812974024:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812974042:aes(freq, fft_abs, color=order)) +
1607812974062:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812974082:geom_line() +
1607812974099:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812974115:geom_line(aes(y=y_ideal), linetype="solid") +
1607812974134:theme_pander() +
1607812974150:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812974166:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812974184:scale_y_continuous(name="")+
1607812974204:ggtitle(paste0("largura = ", .width))
1607812974239:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812974264:}
1607812976501:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812976557:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607812992449:plot.magnitudes2 <- function(dt, derivative, title="") {
1607812992474:.derivative <- derivative
1607812992493:.order <- dt[, first(order)]
1607812992511:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607812992537:g.widths <- ggplot(dt[(freq>0) & (order == .order) & (derivative == .derivative)],
1607812992556:aes(freq, fft_abs, color=width)) +
1607812992573:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812992592:geom_line() +
1607812992608:geom_line(aes(y=y_ideal), linetype="solid") +
1607812992626:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812992643:theme_pander() +
1607812992660:scale_color_canva("largura", palette = names(canva_palettes)[2]) +
1607812992678:#scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812992693:scale_y_continuous(name="Logaritmo da magnitude") +
1607812992712:ggtitle(paste0("grau = ", .order))
1607812992731:#xlim(0, 0.05)
1607812992774:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607812992794:aes(freq, fft_abs, color=order)) +
1607812992811:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607812992830:geom_line() +
1607812992853:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607812992871:geom_line(aes(y=y_ideal), linetype="solid") +
1607812992890:theme_pander() +
1607812992907:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607812992923:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607812992940:scale_y_continuous(name="")+
1607812992960:ggtitle(paste0("largura = ", .width))
1607812992992:return(arrangeGrob(g.widths, g.orders, nrow=2))
1607812993018:}
1607812993049:```{r}
1607812993237:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607812993840:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607813049641:plot.magnitudes2 <- function(dt, derivative, title="") {
1607813049667:.derivative <- derivative
1607813049685:.order <- dt[, first(order)]
1607813049702:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607813049731:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607813049751:aes(freq, fft_abs, color=order)) +
1607813049767:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607813049784:geom_line() +
1607813049801:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607813049818:geom_line(aes(y=y_ideal), linetype="solid") +
1607813049836:theme_pander() +
1607813049854:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607813049872:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607813049889:scale_y_continuous(name="")+
1607813049907:ggtitle(paste0("largura = ", .width))
1607813049939:return(g.orders)
1607813049961:}
1607813052433:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607813052602:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607813083369:plot.magnitudes2 <- function(dt, derivative, title="") {
1607813083393:.derivative <- derivative
1607813083412:.order <- dt[, first(order)]
1607813083430:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607813083467:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607813083485:aes(freq, fft_abs, color=order)) +
1607813083503:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607813083521:geom_line() +
1607813083539:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607813083556:geom_line(aes(y=y_ideal), linetype="solid") +
1607813083575:theme_pander() +
1607813083593:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607813083610:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607813083629:scale_y_continuous(name="")+
1607813083648:ggtitle(paste0("largura = ", .width)) +
1607813083667:ylim(0, 0.1)
1607813083702:return(g.orders)
1607813083728:}
1607813084752:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607813084904:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607813093919:plot.magnitudes2 <- function(dt, derivative, title="") {
1607813093943:.derivative <- derivative
1607813093961:.order <- dt[, first(order)]
1607813093977:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607813094008:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607813094025:aes(freq, fft_abs, color=order)) +
1607813094043:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607813094062:geom_line() +
1607813094078:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607813094095:geom_line(aes(y=y_ideal), linetype="solid") +
1607813094112:theme_pander() +
1607813094130:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607813094148:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607813094166:scale_y_continuous(name="")+
1607813094181:ggtitle(paste0("largura = ", .width)) +
1607813094199:ylim(0, 0.25)
1607813094229:return(g.orders)
1607813094258:}
1607813094284:```{r}
1607813094441:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607813094775:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607813125825:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607813125846:aes(freq, fft_abs, color=order)) +
1607813125866:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607813125885:geom_line() +
1607813125903:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607813125920:geom_line(aes(y=y_ideal), linetype="solid") +
1607813125938:theme_pander() +
1607813125954:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607813125972:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607813125991:scale_y_continuous(name="")+
1607813126011:ggtitle(paste0("largura = ", .width)) +
1607813126031:ylim(0, 0.5)
1607813126705:plot.magnitudes2 <- function(dt, derivative, title="") {
1607813126730:.derivative <- derivative
1607813126750:.order <- dt[, first(order)]
1607813126772:.width <- dt[to.numeric(width) > 2*max(to.numeric(order)), first(width)]
1607813126802:g.orders <- ggplot(dt[(freq>0) & (width == .width) & (derivative == .derivative)],
1607813126818:aes(freq, fft_abs, color=order)) +
1607813126836:geom_hline(yintercept=0, color=.gray, alpha=0.4) +
1607813126851:geom_line() +
1607813126870:geom_hline(yintercept=-3, color="black", alpha=0.8, linetype="dashed") +
1607813126889:geom_line(aes(y=y_ideal), linetype="solid") +
1607813126907:theme_pander() +
1607813126924:scale_color_canva("grau", palette = names(canva_palettes)[3]) +
1607813126940:scale_x_continuous(name=expression(omega*"/2"*pi)) +
1607813126959:scale_y_continuous(name="")+
1607813126975:ggtitle(paste0("largura = ", .width)) +
1607813126993:ylim(0, 0.5)
1607813127028:return(g.orders)
1607813127056:}
1607813127088:```{r}
1607813127235:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607813127560:plot.magnitudes2(sel.dt, derivative=2)  %>% plot
1607813200530:sel.dt <- dt[width %in% c(11, 31, 71, 131)][order %in% c(3, 5, 7, 9)]
1607813200721:g.der0 <- plot.magnitudes(sel.dt, derivative=0)
1607813201087:g.der1 <- plot.magnitudes(sel.dt, derivative=1)
1607813201374:g.der2 <- plot.magnitudes(sel.dt, derivative=2)
1607817131981:dt.cutoff <- copy(dt)
1607817132017:dt.cutoff <- dt.cutoff[ (freq >= 0) & (mag_ratio <= -3)]
1607817132065:dt.cutoff <- dt.cutoff[, .SD[freq==min(freq)], by=.(order, width, derivative)]
1607817132138:dt.cutoff[, estimated := as.numeric(order)/((as.numeric(as.character(width))))]
1607817132163:plot.cutoff <- function(derivative, guide="legend") {
1607817132182:.derivative <- derivative
1607817132198:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607817132216:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607817132236:geom_line() +
1607817132254:#geom_point(aes(y=estimated)) +
1607817132272:geom_point() +
1607817132290:theme_pander() +
1607817132310:scale_x_continuous("Grau") +
1607817132328:scale_y_continuous("Frequência de corte") +
1607817132349:scale_color_gradientn("largura", colors=c("#93b6db", "#505160"), guide=guide) +
1607817132368:coord_cartesian(ylim=c(NA, 0.12))
1607817132387:return(g)
1607817132405:}
1607817132438:g.cutoff.der0 <- plot.cutoff(0, guide="none")
1607817132499:g.cutoff.der1 <- plot.cutoff(1)
1607817132526:g.cutoff.der2 <- plot.cutoff(2)
1607817132558:plot(g.cutoff.der0)
1607817132765:plot(g.cutoff.der1)
1607817134413:plot(g.cutoff.der2)
1607817141747:g.cutoff.der0
1607817245904:plot.cutoff <- function(derivative, guide="colorbar") {
1607817245926:.derivative <- derivative
1607817245945:g <- ggplot(dt.cutoff[ (derivative == .derivative) & (freq < 0.12)],
1607817245965:aes(x=as.numeric(order), y=freq, color=as.numeric(as.character(width)), group=width)) +
1607817245985:geom_line() +
1607817246001:#geom_point(aes(y=estimated)) +
1607817246019:geom_point() +
1607817246035:theme_pander() +
1607817246052:scale_x_continuous("Grau") +
1607817246070:scale_y_continuous("Frequência de corte") +
1607817246088:scale_color_gradientn("largura", colors=c("#93b6db", "#505160"), guide=guide) +
1607817246107:coord_cartesian(ylim=c(NA, 0.12))
1607817246126:return(g)
1607817246144:}
1607817250633:plot.cutoff(1)
